(function(){"use strict";const L="theme",Z="miroza_subscribers",k="https://miroza.online";window.MIROZA=window.MIROZA||{},window.MIROZA.utils={qs:(i,t=document)=>t.querySelector(i),qsa:(i,t=document)=>Array.from(t.querySelectorAll(i)),shuffle(i){let t=i.length,r,e;for(;t;)e=Math.floor(Math.random()*t--),r=i[t],i[t]=i[e],i[e]=r;return i},safeHTML(i){if(window.DOMPurify)return DOMPurify.sanitize(i,{USE_PROFILES:{html:!0}});const t=document.createElement("div");return t.textContent=i,t.innerHTML},formatNumber(i){try{return Intl.NumberFormat("en-US",{notation:"compact",maximumFractionDigits:1}).format(i||0)}catch(t){return i||0}},debounce(i,t){let r;return function(...e){clearTimeout(r),r=setTimeout(()=>i.apply(this,e),t)}}},window.MIROZA.store=function(){let i=[],t=null;function r(){return t||(t=Promise.all([fetch("/data/posts.json").then(e=>e.ok?e.json():[])]).then(([e])=>(i=e,!0)).catch(e=>(console.error("Failed to load data:",e),!1)),t)}return{init:r,ready:()=>t,getAll:()=>i,getByCategory:e=>i.filter(a=>a.category===e)}}(),window.MIROZA.builder=function(){function i(t){const r=document.createElement("article");r.className="card post-card";const e=t.image,a=e?typeof e=="string"?e:e.src||"/assets/images/hero-insight-800.svg":"/assets/images/hero-insight-800.svg",l=e&&typeof e=="object"&&e.alt?e.alt:t.title||"";let s=t.link||t.url||"";if(!s)if(t.slug){const d=(t.category||"").toLowerCase();d==="blog"?s=`/blogs/${t.slug}.html`:d==="news"||d==="india"?s=`/news/${t.slug}.html`:s=`/articles/${t.slug}.html`}else s="/";let n="",o="";e&&typeof e=="object"&&(e.srcset&&(n=`srcset="${e.srcset}"`),e.sizes&&(o=`sizes="${e.sizes}"`));const c=`
        <a href="${s}" class="card-link" aria-label="Read ${window.MIROZA.utils.safeHTML(t.title||"")}">
          <div class="card-image-wrap">
             <img src="${a}" ${n} ${o} alt="${window.MIROZA.utils.safeHTML(l)}" loading="lazy" decoding="async" width="400" height="225" onerror="this.onerror=null;this.src='/assets/images/hero-insight-800.svg'" />
          </div>
          <div class="card-content card-body">
            <div class="card-meta">
              <span class="category">${window.MIROZA.utils.safeHTML(t.category||"Story")}</span> \u2022
              <span class="date">${t.date?new Date(t.date).toLocaleDateString():""}</span>
            </div>
            <h3 class="card-title">
              ${window.MIROZA.utils.safeHTML(t.title||"")}
            </h3>
            <p class="card-excerpt">${window.MIROZA.utils.safeHTML(t.excerpt||"")}</p>
            <span class="read-more" aria-hidden="true">Read Article</span>
          </div>
        </a>
      `;return r.innerHTML=c,r}return{build:i}}(),window.MIROZA.theme=function(){function i(){const e=localStorage.getItem(L);e?document.documentElement.dataset.theme=e:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(document.documentElement.dataset.theme="dark"),r()}function t(){const a=(document.documentElement.dataset.theme||"light")==="dark"?"light":"dark";document.documentElement.dataset.theme=a,localStorage.setItem(L,a),r()}function r(){const e=window.MIROZA.utils.qs(".theme-toggle img");if(e){const a=document.documentElement.dataset.theme==="dark";e.src=a?"/assets/icons/sun.svg":"/assets/icons/moon.svg",e.alt=a?"Switch to light mode":"Switch to dark mode"}}return{init:i,toggle:t}}(),window.MIROZA.nav=function(){let i=!1;function t(){const e=window.location.pathname,a=window.MIROZA.utils.qsa(".main-nav a");let l=!1;a.forEach(s=>{const n=s.getAttribute("href");e===n||e==="/"&&n==="/index.html"||e==="/index.html"&&n==="/"?(s.setAttribute("aria-current","page"),l=!0):s.removeAttribute("aria-current")}),!l&&a.forEach(s=>{const n=s.getAttribute("href");if(n==="/"||n==="/index.html")return;const o=n.split("/")[1];o&&e.includes(`/${o}/`)&&s.setAttribute("aria-current","page")})}function r(){t();const e=window.MIROZA.utils.qs(".menu-toggle"),a=window.MIROZA.utils.qs(".main-nav");!e||!a||(e.addEventListener("click",()=>{i=!i,a.classList.toggle("open",i),e.setAttribute("aria-expanded",i),e.innerHTML=i?'<img src="/assets/icons/close.svg" alt="Close" width="24" height="24" />':'<img src="/assets/icons/menu.svg" alt="Menu" width="24" height="24" />'}),a.addEventListener("click",l=>{l.target.tagName==="A"&&(i=!1,a.classList.remove("open"),e.setAttribute("aria-expanded","false"),e.innerHTML='<img src="/assets/icons/menu.svg" alt="Menu" width="24" height="24" />')}))}return{init:r}}(),window.MIROZA.ui=function(){let i,t,r=!1;function e(){const n=window.scrollY||document.documentElement.scrollTop||0;i&&i.classList.toggle("is-stuck",n>24),t&&t.classList.toggle("visible",n>480)}function a(){t&&t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})}function l(){const n=window.MIROZA.utils.qsa(".single-article img, main img[data-enhance-responsive]");n.length&&n.forEach(o=>{o&&(o.getAttribute("loading")||(o.loading="lazy"),o.decoding="async")})}function s(){i=window.MIROZA.utils.qs(".site-header"),t=window.MIROZA.utils.qs(".back-to-top"),a(),window.addEventListener("scroll",()=>{r||(r=!0,window.requestAnimationFrame(()=>{e(),r=!1}))},{passive:!0}),e(),l()}return{init:s}}(),window.MIROZA.search=function(){function i(){const t=window.MIROZA.utils.qs("#search"),r=window.MIROZA.utils.qs("#search-suggestions");!t||!r||!window.MIROZA.store||(t.addEventListener("input",window.MIROZA.utils.debounce(e=>{const a=e.target.value.toLowerCase();if(a.length<2){r.hidden=!0;return}const s=window.MIROZA.store.getAll().filter(n=>(n.title||"").toLowerCase().includes(a)).slice(0,5);r.innerHTML="",s.length?(r.hidden=!1,s.forEach(n=>{const o=document.createElement("button");o.className="search-suggestion",o.innerHTML=`<strong>${window.MIROZA.utils.safeHTML(n.title)}</strong><br><span>${window.MIROZA.utils.safeHTML(n.category||"")}</span>`,o.addEventListener("click",()=>{window.location.href=n.link||`/articles/${n.slug}.html`}),r.appendChild(o)})):r.hidden=!0},300)),document.addEventListener("click",e=>{!t.contains(e.target)&&!r.contains(e.target)&&(r.hidden=!0)}))}return{init:i}}(),window.MIROZA.subscription=function(){function i(){const e=window.MIROZA.utils.qs("#newsletter-form");if(!e)return;if(!e.querySelector('input[type="email"]')){const l=document.createElement("input");l.type="email",l.placeholder="Your email address",l.required=!0,l.setAttribute("aria-label","Email address"),e.insertBefore(l,e.querySelector("button"))}e.addEventListener("submit",l=>{l.preventDefault();const s=e.querySelector('input[type="email"]'),n=s.value.trim();if(!n)return;t(n);const o=e.querySelector("button").textContent;e.querySelector("button").textContent="Subscribed!",e.querySelector("button").disabled=!0,s.value="",setTimeout(()=>{e.querySelector("button").textContent=o,e.querySelector("button").disabled=!1},3e3)});const a=window.MIROZA.utils.qs(".newsletter h3");a&&(a.addEventListener("dblclick",r),a.title="Admin: Double click to download subscriber list")}function t(e){let a=[];try{const s=localStorage.getItem(Z);s&&(a=JSON.parse(s))}catch(s){}const l={email:e,date:new Date().toISOString(),source:"newsletter-form"};a.push(l),localStorage.setItem(Z,JSON.stringify(a)),console.log("Subscriber saved locally:",l)}function r(){let e=[];try{const c=localStorage.getItem(Z);c&&(e=JSON.parse(c))}catch(c){}if(!e.length){alert("No subscribers yet.");return}const a=`Email,Date,Source
`,l=e.map(c=>`${c.email},${c.date},${c.source}`).join(`
`),s=new Blob([a+l],{type:"text/csv"}),n=URL.createObjectURL(s),o=document.createElement("a");o.href=n,o.download="subscribers.csv",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n)}return{init:i}}(),window.MIROZA.home=function(){function i(r,e){const a=window.MIROZA.utils.qs(`#${r}`);a&&(a.innerHTML="",e.forEach(l=>{a.appendChild(window.MIROZA.builder.build(l))}))}function t(){if(!window.MIROZA.store)return;const r=window.MIROZA.store.getAll();if(!r||!r.length)return;let e=[];try{fetch("/data/news.json").then(n=>n.ok?n.json():[]).then(n=>{if(n&&n.length){const c=n.slice().sort((d,h)=>(h.date||"").localeCompare(d.date||"")).slice(0,4).map(d=>({title:d.title,slug:d.slug,date:d.date,category:d.category||"News",excerpt:d.excerpt,link:d.contentFile||`/news/${d.slug}.html`,image:d.image?{src:d.image,alt:d.title}:null}));i("news-cards",c);return}const o=r.filter(c=>c.category==="News").slice(0,4);i("news-cards",o)}).catch(()=>{const n=r.filter(o=>o.category==="News").slice(0,4);i("news-cards",n)})}catch(n){const o=r.filter(c=>c.category==="News").slice(0,4);i("news-cards",o)}const a=r.filter(n=>n.category==="Blog").slice(0,4),l=r.filter(n=>n.category!=="News"&&n.category!=="Blog").slice(0,4);i("blog-cards",a),i("articles-cards",l);const s=window.MIROZA.utils.shuffle(r.slice(0)).slice(0,8);i("latest-cards",s)}return{init:t}}(),window.MIROZA.indiaNews=function(){function i(e){return{title:e.title,slug:e.slug,date:e.date,category:"India",excerpt:e.excerpt,link:e.contentFile||`/news/${e.slug}.html`,image:e.image?{src:e.image,alt:e.title}:null}}function t(){try{return new URLSearchParams(window.location.search).get("topic")}catch(e){return null}}function r(){const e=window.MIROZA.utils.qs("#india-news-list");e&&fetch("/data/news.json").then(a=>a.ok?a.json():[]).then(a=>{e.innerHTML="";let l=a.slice().sort((n,o)=>(o.date||"").localeCompare(n.date||""));const s=t();if(s&&(l=l.filter(n=>(n.category||"").toLowerCase()===s.toLowerCase()||(n.title||"").toLowerCase().includes(s.toLowerCase()))),l.length===0){e.innerHTML="<p>No news found for this topic.</p>";return}l.forEach(n=>{e.appendChild(window.MIROZA.builder.build(i(n)))})}).catch(()=>{e.innerHTML="<p>Unable to load latest India news right now.</p>"})}return{init:r}}(),window.MIROZA.listing=function(){function i(){try{const n=new URLSearchParams(window.location.search),o=parseInt(n.get("page"),10);return isNaN(o)||o<1?1:o}catch(n){return 1}}function t(){try{return new URLSearchParams(window.location.search).get("topic")}catch(n){return null}}function r(n){try{const o=new URL(window.location.href);o.searchParams.set("page",String(n)),window.history.replaceState({},"",o.toString())}catch(o){}}function e(n,o,c=12,d=null){const h=window.MIROZA.utils.qs(n);if(!h)return null;h.innerHTML="";const p=d||i()||1,w={items:o,pageSize:c,index:(p-1)*c};w.index>0&&w.items.slice(0,w.index).forEach(m=>h.appendChild(window.MIROZA.builder.build(m)));function b(){const g=w.items.slice(w.index,w.index+w.pageSize);return g.forEach(m=>h.appendChild(window.MIROZA.builder.build(m))),w.index+=g.length,w.index<w.items.length}w.index===0&&b();const u=Math.ceil(w.index/w.pageSize)||1;return r(u),{renderNext:b,state:w}}function a(n,o){const c=window.MIROZA.utils.qs(n);if(!c||!o||(c.innerHTML="",o.state.index>=o.state.items.length))return;const d=document.createElement("button");d.className="load-more",d.textContent="Load more",d.addEventListener("click",()=>{const h=o.renderNext(),p=Math.ceil(o.state.index/o.state.pageSize)||1;r(p),h||d.remove()}),c.appendChild(d)}function l(){const n="#articles-list",o="#articles-pagination";if(!window.MIROZA.store||!window.MIROZA.utils.qs(n))return;const c=window.MIROZA.store.getAll();if(!c||!c.length){window.MIROZA.utils.qs(n).innerHTML="<p>No articles found.</p>";return}const d=t();let h=c.filter(w=>w.category!=="Blog").slice().sort((w,b)=>(b.date||"").localeCompare(w.date||""));d&&(h=h.filter(w=>(w.category||"").toLowerCase()===d.toLowerCase()||(w.title||"").toLowerCase().includes(d.toLowerCase())));const p=e(n,h,12);a(o,p)}async function s(){const n="#posts-grid";let o="#blogs-pagination";if(window.MIROZA.utils.qs(n)){if(!window.MIROZA.utils.qs(o)){const c=document.createElement("nav");c.id="blogs-pagination",c.className="pagination",window.MIROZA.utils.qs(n).parentNode.appendChild(c)}try{const c=await fetch("/data/blogs.json");let d=[];c.ok?d=await c.json():(await window.MIROZA.store.init(),d=window.MIROZA.store.getAll().filter(u=>u.category==="Blog"));let h=d.slice().sort((u,g)=>(g.date||"").localeCompare(u.date||"")).map(u=>({title:u.title,slug:u.slug,date:u.date,category:"Blog",excerpt:u.excerpt,link:u.url||u.contentFile||`/blogs/${u.slug}.html`,image:u.image?{src:u.image,alt:u.title}:null}));const p=t();p&&(h=h.filter(u=>(u.title||"").toLowerCase().includes(p.toLowerCase())));const w=e(n,h,12);a(o,w);const b=document.getElementById("posts-skeleton");b&&(b.style.display="none")}catch(c){console.error("Failed to load blogs",c)}}}return{initArticles:l,initBlogs:s}}(),window.MIROZA.postMeta=function(){function i(){var w,b,u,g,m,A,y;const t=document.body.dataset.page||"";if(!/article|news-article|blog-article/.test(t)||document.querySelector('script[type="application/ld+json"]'))return;const r=((w=document.querySelector('meta[property="og:title"]'))==null?void 0:w.getAttribute("content"))||document.title,e=((b=document.querySelector('meta[name="description"]'))==null?void 0:b.getAttribute("content"))||((u=document.querySelector('meta[property="og:description"]'))==null?void 0:u.getAttribute("content"))||"",a=((g=document.querySelector('meta[property="og:image"]'))==null?void 0:g.getAttribute("content"))||((m=document.querySelector("img"))==null?void 0:m.src)||"",l=((A=document.querySelector('link[rel="canonical"]'))==null?void 0:A.href)||window.location.href,s=document.querySelector(".single-article time")||document.querySelector(".meta time"),n=s?s.getAttribute("datetime")||s.textContent:((y=document.querySelector('meta[property="article:published_time"]'))==null?void 0:y.getAttribute("content"))||"",o=document.querySelector(".author")||document.querySelector('meta[name="author"]'),c=o?o.textContent||o.getAttribute("content"):"",h={"@context":"https://schema.org","@type":t==="blog-article"||t==="blog"?"BlogPosting":"NewsArticle",headline:r,description:e,image:a,datePublished:n||void 0,author:c?{"@type":"Person",name:c}:void 0,publisher:{"@type":"Organization",name:"MIROZA",logo:{"@type":"ImageObject",url:location.origin+"/assets/icons/logo.svg"}},mainEntityOfPage:{"@type":"WebPage","@id":l}};Object.keys(h).forEach(M=>h[M]===void 0&&delete h[M]);const p=document.createElement("script");p.type="application/ld+json",p.text=JSON.stringify(h,null,2),document.head.appendChild(p)}return{init:i}}(),window.MIROZA.ads=function(){function i(){const t=window.MIROZA.utils.qsa(".ad-slot");t.length&&t.forEach(r=>{r.dataset.loaded||(r.dataset.loaded="true")})}return{init:i}}(),window.MIROZA.cookieBanner=function(){function i(){if(localStorage.getItem("miroza_cookie_consent"))return;const t=document.createElement("div");if(t.className="cookie-banner",t.innerHTML=`
        <div class="cookie-content">
          <p>We use cookies to improve your experience. By using our site, you agree to our <a href="/privacy.html">Privacy Policy</a>.</p>
          <button id="accept-cookies">Accept</button>
        </div>
      `,document.body.appendChild(t),!document.getElementById("cookie-styles")){const r=document.createElement("style");r.id="cookie-styles",r.textContent=`
          .cookie-banner { position: fixed; bottom: 0; left: 0; right: 0; background: var(--bg-alt, #f1f5f9); border-top: 1px solid var(--border, #e2e8f0); padding: 1rem; z-index: 9999; display: flex; justify-content: center; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); }
          .cookie-content { display: flex; align-items: center; gap: 1rem; max-width: 1200px; width: 100%; justify-content: space-between; flex-wrap: wrap; }
          .cookie-content p { margin: 0; font-size: 0.9rem; color: var(--text, #333); }
          .cookie-content button { background: var(--primary, #2563eb); color: white; border: none; padding: 0.5rem 1.5rem; border-radius: 4px; cursor: pointer; font-weight: 500; }
          .cookie-content button:hover { opacity: 0.9; }
        `,document.head.appendChild(r)}document.getElementById("accept-cookies").addEventListener("click",()=>{localStorage.setItem("miroza_cookie_consent","true"),t.remove()})}return{init:i}}(),document.addEventListener("DOMContentLoaded",()=>{window.MIROZA.theme.init(),window.MIROZA.nav.init(),window.MIROZA.ui.init(),window.MIROZA.subscription.init(),window.MIROZA.ads.init(),window.MIROZA.cookieBanner&&window.MIROZA.cookieBanner.init();const i=window.MIROZA.utils.qs(".theme-toggle");i&&i.addEventListener("click",window.MIROZA.theme.toggle);const t=document.body.dataset.page||"home",r=t==="home",e=t==="india-news",a=t==="articles",l=t==="blog";window.MIROZA.store&&typeof window.MIROZA.store.init=="function"?window.MIROZA.store.init().then(()=>{r&&window.MIROZA.home&&window.MIROZA.home.init(),a&&window.MIROZA.listing&&window.MIROZA.listing.initArticles(),l&&window.MIROZA.listing&&window.MIROZA.listing.initBlogs(),window.MIROZA.search&&window.MIROZA.search.init(),e&&window.MIROZA.indiaNews&&window.MIROZA.indiaNews.init(),window.MIROZA.postMeta&&window.MIROZA.postMeta.init(),document.body.classList.add("js-ready")}).catch(()=>{e&&window.MIROZA.indiaNews&&window.MIROZA.indiaNews.init(),window.MIROZA.postMeta&&window.MIROZA.postMeta.init(),document.body.classList.add("js-ready")}):(e&&window.MIROZA.indiaNews&&window.MIROZA.indiaNews.init(),l&&window.MIROZA.listing&&window.MIROZA.listing.initBlogs(),window.MIROZA.postMeta&&window.MIROZA.postMeta.init(),document.body.classList.add("js-ready"));try{const s=(location.pathname||"").toLowerCase(),n=s.includes("/articles/")&&!/articles(\/|index\.html|articles\.html)$/.test(s),o=s.includes("/blogs/")&&!/blogs(\/|index\.html|blogs\.html)$/.test(s);(n||o)&&function(){"use strict";const c={article:".single-article, main article, .post-content",header:".single-article header",title:"h1",navContainer:".article-nav",shareContainer:".article-share"};function d(){const g=location.pathname.match(/\/(articles|blogs|news)\/([^/]+)\.html$/);return g?g[2]:null}function h(){const u=location.pathname;return u.includes("/articles/")?"Articles":u.includes("/blogs/")?"Blogs":u.includes("/news/")?"News":"Home"}function p(){var I;if(!document.querySelector(c.article)||document.querySelector(".breadcrumbs"))return;const g=h(),m=`/${g.toLowerCase()}/${g.toLowerCase()}.html`,A=((I=document.querySelector("h1"))==null?void 0:I.textContent)||"Current Page",y=`
              <nav class="breadcrumbs" aria-label="Breadcrumb">
                <ol>
                  <li><a href="/">Home</a></li>
                  <li><a href="${m}">${g}</a></li>
                  <li aria-current="page">${A}</li>
                </ol>
              </nav>
            `,M=document.querySelector(c.header);if(M){const R=document.createElement("div");R.innerHTML=y,M.parentNode.insertBefore(R.firstElementChild,M)}}function w(){const u=document.querySelector(c.article);if(!u||document.querySelector(c.shareContainer))return;const g=encodeURIComponent(window.location.href),m=encodeURIComponent(document.title),A=`
              <div class="article-share">
                <h3>Share this story</h3>
                <div class="share-buttons">
                  <a href="https://twitter.com/intent/tweet?text=${m}&url=${g}" target="_blank" rel="noopener noreferrer" class="share-btn twitter" aria-label="Share on Twitter"><span>Twitter</span></a>
                  <a href="https://www.facebook.com/sharer/sharer.php?u=${g}" target="_blank" rel="noopener noreferrer" class="share-btn facebook" aria-label="Share on Facebook"><span>Facebook</span></a>
                  <a href="https://www.linkedin.com/shareArticle?mini=true&url=${g}&title=${m}" target="_blank" rel="noopener noreferrer" class="share-btn linkedin" aria-label="Share on LinkedIn"><span>LinkedIn</span></a>
                  <a href="https://api.whatsapp.com/send?text=${m}%20${g}" target="_blank" rel="noopener noreferrer" class="share-btn whatsapp" aria-label="Share on WhatsApp"><span>WhatsApp</span></a>
                </div>
              </div>
            `,y=document.createElement("div");y.innerHTML=A,u.appendChild(y.firstElementChild)}async function b(){const u=d();if(u)try{let g=[];if(window.MIROZA.store&&window.MIROZA.store.ready())g=window.MIROZA.store.getAll();else{const f=await fetch("/data/posts.json");if(!f.ok)return;g=await f.json()}const m=g.sort((f,O)=>new Date(O.date||0)-new Date(f.date||0)),A=m.findIndex(f=>f.slug===u||f.link&&f.link.includes(u));if(A===-1)return;const y=m[A],M=m[A-1],I=m[A+1],R=document.querySelector(c.article);if(!R)return;if(M||I){const f=`
                  <nav class="article-nav" aria-label="Article navigation">
                    ${I?`<a href="${I.link||I.url}" class="nav-link prev"><span class="nav-label">&larr; Previous</span><span class="nav-title">${I.title}</span></a>`:'<div class="nav-spacer"></div>'}
                    ${M?`<a href="${M.link||M.url}" class="nav-link next"><span class="nav-label">Next &rarr;</span><span class="nav-title">${M.title}</span></a>`:'<div class="nav-spacer"></div>'}
                  </nav>
                `,O=document.createElement("div");O.innerHTML=f,R.appendChild(O.firstElementChild)}const S=g.filter(f=>f.category===y.category&&f.slug!==y.slug).slice(0,3);if(S.length>0){const f=`
                  <section class="related-articles">
                    <h3>You might also like</h3>
                    <div class="related-grid">
                      ${S.map(v=>`<a href="${v.link}" class="related-card"><div class="related-image"><img src="${v.image||"/assets/images/hero-insight-800.svg"}" alt="${v.title}" loading="lazy"></div><h4>${v.title}</h4></a>`).join("")}
                    </div>
                  </section>
                `,O=document.createElement("div");O.innerHTML=f,R.appendChild(O.firstElementChild)}}catch(g){console.error("Nav load failed",g)}}p(),w(),b()}()}catch(s){}}),window.MIROZA.loadPosts=async()=>(await window.MIROZA.store.init(),window.MIROZA.store.getAll()),window.MIROZA.buildCard=window.MIROZA.builder.build})();

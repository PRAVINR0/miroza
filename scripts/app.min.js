(function(){"use strict";const le="miroza_theme";function ue(){try{const o=localStorage.getItem(le);return o==="dark"||o==="light"?o:null}catch(o){return null}}(function(){const s=ue();if(s&&document.documentElement.dataset.theme!==s){document.documentElement.dataset.theme=s;return}!s&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(document.documentElement.dataset.theme="dark")})();const me={world:"World",science:"Science",health:"Health",space:"Space",economy:"Economy",technology:"Technology",weather:"Weather",business:"Business",finance:"Finance",education:"Education",climate:"Climate",travel:"Travel",culture:"Culture",analysis:"Analysis",ideas:"Ideas",lifestyle:"Lifestyle",automobiles:"Automobiles",career:"Career",energy:"Energy",security:"Security"},re={news:"/news.html","india-news":"/news.html",india:"/news.html",blog:"/blog.html",article:"/articles.html",articles:"/articles.html",story:"/articles.html",posts:"/articles.html"};Object.entries(me).forEach(([o,s])=>{re[o]||(re[o]=`/articles.html?topic=${encodeURIComponent(s)}`)});function de(o){return(o||"").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function fe(o){const s=de(o);return re[s]||null}function ge(){var s;if(!((s=window.MIROZA)!=null&&s.utils))return;const o=new Set(["/news/index.html","news/index.html"]);window.MIROZA.utils.qsa("a[href]").forEach(a=>{const t=a.getAttribute("href")||"";if(o.has(t)){a.setAttribute("href","/news.html"),a.dataset.prefetch=a.dataset.prefetch||"";return}}),window.MIROZA.utils.qsa('a[href^="/category/"]').forEach(a=>{const t=a.getAttribute("href")||"",u=de(t.replace("/category/","").replace(/\.html?$/,"")),b=fe(u);b&&(a.setAttribute("href",b),a.dataset.prefetch=a.dataset.prefetch||"")})}document.documentElement.classList.add("js-ready"),window.MIROZA=window.MIROZA||{},window.MIROZA.utils={qs:(o,s=document)=>s.querySelector(o),qsa:(o,s=document)=>Array.from(s.querySelectorAll(o)),shuffle(o){for(let s=o.length-1;s>0;s--){const a=Math.floor(Math.random()*(s+1));[o[s],o[a]]=[o[a],o[s]]}return o},safeHTML(o){if(window.DOMPurify)return DOMPurify.sanitize(o,{USE_PROFILES:{html:!0}});const s=document.createElement("div");return s.textContent=o,s.innerHTML},prefersReducedMotion(){return window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches},formatNumber(o){try{return Intl.NumberFormat("en-US",{notation:"compact",maximumFractionDigits:1}).format(o||0)}catch(s){return o||0}},isInternalLink(o){try{return new URL(o,window.location.origin).origin===window.location.origin}catch(s){return!1}}},window.MIROZA.shell=(function(){const o=[{label:"Home",href:"/",match:["/"]},{label:"News",href:"/news.html",startsWith:["/news"]},{label:"Articles",href:"/articles.html",startsWith:["/articles"]},{label:"Blogs",href:"/blog.html",startsWith:["/blog","/blogs"]},{label:"About",href:"/#about",hash:"#about",homeOnly:!0},{label:"Contact",href:"/#contact",hash:"#contact",homeOnly:!0}];function s(){a()}function a(){const l=window.MIROZA.utils.qs(".main-nav");if(!l)return;let f=l.querySelector("ul");f||(f=document.createElement("ul"),l.appendChild(f)),f.innerHTML="",o.forEach(r=>{const p=document.createElement("li"),R=document.createElement("a");R.href=r.href,R.textContent=r.label,R.setAttribute("data-prefetch",""),t(r)&&R.setAttribute("aria-current","page"),p.appendChild(R),f.appendChild(p)}),l.dataset.shellReady="true"}function t(l){const f=c(window.location.pathname);return l.startsWith&&u(f,l.startsWith)||l.match&&b(f,l.match)?!0:l.hash?l.homeOnly?f==="/"&&window.location.hash===l.hash:window.location.hash===l.hash:l.href==="/"&&f==="/"&&!window.location.hash}function u(l,f){return(Array.isArray(f)?f:[f]).some(p=>l.startsWith(p))}function b(l,f){return(Array.isArray(f)?f:[f]).includes(l)}function c(l){if(!l)return"/";const f=l.replace(/\\/g,"/").replace(/\/index\.html$/i,"/");return f===""?"/":f}return{init:s,enhanceNav:a}})();const te="(max-width: 600px) 100vw, (max-width: 1200px) 50vw, 400px",G={src:"/assets/images/hero-insight-800.svg",srcset:"/assets/images/hero-insight-400.svg 400w, /assets/images/hero-insight-800.svg 800w, /assets/images/hero-insight-1200.svg 1200w",sizes:te,alt:"MIROZA featured story"};function he(o,s={}){var d,h,M,T;if(!o||typeof o!="object")return null;const a=document.createElement("article");a.className="card fade-in",a.setAttribute("data-id",o.id),a.dataset.label=o.category||"Story",((h=(d=window.MIROZA.posts)==null?void 0:d.isTrending)==null?void 0:h.call(d,o.id))?a.dataset.trending="true":a.removeAttribute("data-trending"),typeof s.order=="number"&&a.style.setProperty("--card-order",s.order);const u=o.image||G,b=document.createElement("picture");Array.isArray(u.sources)&&u.sources.forEach(I=>{const q=document.createElement("source");Object.entries(I||{}).forEach(([N,B])=>{B&&q.setAttribute(N,B)}),b.appendChild(q)});const c=document.createElement("img");c.loading="lazy",c.decoding="async",c.src=u.src||G.src,u.srcset&&c.setAttribute("srcset",u.srcset),c.setAttribute("sizes",u.sizes||te),c.alt=u.alt||o.title,c.width=400,c.height=225,b.appendChild(c),a.appendChild(b);const l=document.createElement("div");l.className="card-content";const f=document.createElement("h3");f.className="card-title",f.innerHTML=window.MIROZA.utils.safeHTML(o.title);const r=document.createElement("p");r.className="card-meta";const p=window.MIROZA.utils.formatNumber(o.views||0),R=o.metaLabel||`${o.category||"Story"} \u2022 ${p} views`;r.textContent=R;const k=document.createElement("p");k.className="card-excerpt",k.innerHTML=window.MIROZA.utils.safeHTML(o.excerpt);const y=document.createElement("a");return y.href=o.link||"/articles/"+o.slug+".html",y.textContent="Read More \u2192",y.className="read-more",y.setAttribute("data-prefetch",""),y.setAttribute("data-transition",""),y.dataset.trackStory=(T=(M=o.id)!=null?M:o.slug)!=null?T:"",y.dataset.trackSlug=o.slug||"",y.dataset.trackTitle=o.title,y.dataset.trackCategory=o.category||"Story",l.appendChild(f),l.appendChild(r),l.appendChild(k),l.appendChild(y),a.appendChild(l),a}window.MIROZA.buildCard=he,window.MIROZA.hero=(function(){const a=["Climate finance, corridors, and civic infrastructure.","Ports, policy, and the people connecting them.","Signals our partners brief boards with before dawn.","Emerging market pilots, resilience, and governance."];let t=[],u=0,b=null,c=0,l=null,f=!1;const r={tag:null,title:null,excerpt:null,link:null,picture:null,image:null,advance:null,tagline:null};function p(){r.tag=window.MIROZA.utils.qs("#hero-tag"),r.title=window.MIROZA.utils.qs("[data-hero-title]"),r.excerpt=window.MIROZA.utils.qs("[data-hero-excerpt]"),r.link=window.MIROZA.utils.qs("#hero-link"),r.picture=window.MIROZA.utils.qs("#hero-picture"),r.image=window.MIROZA.utils.qs("#hero-image"),r.advance=window.MIROZA.utils.qs(".hero-advance"),r.tagline=window.MIROZA.utils.qs("[data-hero-tagline]")}function R(){var L;f||(f=!0,(L=r.advance)==null||L.addEventListener("click",()=>N(!0)))}function k(){b&&(window.clearInterval(b),b=null)}function y(){t.length<=1||window.MIROZA.utils.prefersReducedMotion()||(k(),b=window.setInterval(()=>N(!1),12e3))}function d(){if(!r.tagline||a.length<2){a.length===1&&q(a[0]);return}h(),q(a[c]),!window.MIROZA.utils.prefersReducedMotion()&&(l=window.setInterval(()=>M(),9e3))}function h(){l&&(window.clearInterval(l),l=null)}function M(){c=(c+1)%a.length,q(a[c])}function T(L){return L.link||(L.slug?`/articles/${L.slug}.html`:"#")}function I(L){var E,S;if(!L)return;const U=window.MIROZA.utils.safeHTML;r.tag&&(r.tag.textContent=L.category||"Featured Story"),r.title&&(r.title.innerHTML=U(L.title)),r.excerpt&&(r.excerpt.innerHTML=U(L.excerpt)),r.link&&(r.link.href=T(L),r.link.setAttribute("data-prefetch",""),r.link.dataset.trackStory=(S=(E=L.id)!=null?E:L.slug)!=null?S:"hero",r.link.dataset.trackSlug=L.slug||"",r.link.dataset.trackTitle=L.title,r.link.dataset.trackCategory=L.category||"Story");const w=L.image||G;r.image&&(r.image.src=w.src||G.src,w.srcset&&(r.image.srcset=w.srcset),r.image.sizes=w.sizes||te,r.image.alt=w.alt||L.title),r.picture&&(r.picture.dataset.storyId=L.id)}function q(L){!r.tagline||!L||(r.tagline.textContent=L)}function N(L=!1){t.length&&(u=(u+1)%t.length,I(t[u]),L&&y())}function B(L=[]){p(),t=L.filter(Boolean),u=0,t.length&&(I(t[0]),R(),y(),d())}function P(L=[]){if(t=L.filter(Boolean),u=0,!t.length){k(),h();return}I(t[0]),y(),d()}return{mount:B,setItems:P,next:()=>N(!0)}})(),window.MIROZA.theme=(function(){const o=le;function s(){return document.documentElement.dataset.theme||"light"}function a(c,{persist:l=!0}={}){const f=c==="dark"?"dark":"light";if(document.documentElement.dataset.theme=f,l)try{localStorage.setItem(o,f)}catch(r){}u()}function t(){a(s()==="light"?"dark":"light")}function u(){const c=window.MIROZA.utils.qs(".theme-toggle img");if(!c)return;const l=s()==="light";c.src=l?"/assets/icons/moon.svg":"/assets/icons/sun.svg",c.alt=l?"Enable dark mode":"Enable light mode"}function b(){const c=ue();c&&c!==s()&&(document.documentElement.dataset.theme=c),u()}return{init:b,toggle:t,set:a}})(),window.MIROZA.nav=(function(){let o=!1,s,a;function t(){o?(s.classList.add("open"),a.setAttribute("aria-expanded","true"),a.innerHTML='<img src="/assets/icons/close.svg" alt="Close" width="24" height="24" />'):(s.classList.remove("open"),a.setAttribute("aria-expanded","false"),a.innerHTML='<img src="/assets/icons/menu.svg" alt="Menu" width="24" height="24" />')}function u(){var c;o=!o,t(),o?(c=s.querySelector("a"))==null||c.focus():a.focus()}function b(){s=window.MIROZA.utils.qs(".main-nav"),a=window.MIROZA.utils.qs(".menu-toggle"),!(!s||!a)&&a.addEventListener("click",u)}return{init:b,toggle:u}})(),window.MIROZA.posts=(function(){const o="/data/articles.json",s="/data/posts.json",a="/data/news.json";let t=[],u=null,b=[],c=new Set,l=[];const f=new Map;function r(i){return(i||"").toLowerCase()}function p(i,m="article"){const v=r(i);return v?v==="india-news"?"news":v:m}function R(i){const m=r(i);return m==="news"||m==="india"}function k(i){return r(i)==="blog"}function y(i){const m=r(i);return m?m!=="news"&&m!=="blog":!1}function d(i,m,v){if(!m)return"#";const C=p(i),O=r(v);return C==="blog"||O==="blog"?`/blogs/${m}.html`:C==="news"||O==="news"||O==="india"?`/news/${m}.html`:`/articles/${m}.html`}function h(i,m){if(!i)return!1;const v=r(m);return v?p(i.contentType||i.category)===v:!1}function M(i,m){return i?typeof i=="string"?{src:i,alt:m||"Story art",sizes:te}:{src:i.src||G.src,srcset:i.srcset||G.srcset,sizes:i.sizes||te,alt:i.alt||m||G.alt,sources:Array.isArray(i.sources)?i.sources:void 0}:{...G,alt:m||G.alt}}function T(i){if(!i)return"";const m=new Date(i);if(Number.isNaN(m.getTime()))return"";try{return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(m)}catch(v){return m.toISOString().slice(0,10)}}function I(i,m,v="article"){const C=i.slug||`story-${i.id||m+1}`,O=i.category||"Story",D=r(O),e=p(i.contentType||v),n=Date.parse(i.date||i.updated||"")||Date.now()-m,g=i.link||i.contentFile||d(e,C,O),A=i.metaLabel||[O,T(i.date)].filter(Boolean).join(" \u2022 "),Z=i.excerpt||i.summary||"",_=M(i.image,i.title),z=D==="news"?1150-m*12:1600-m*20,V=typeof i.views=="number"?i.views:z;return{...i,slug:C,category:O,link:g,dateValue:n,metaLabel:A,excerpt:Z,image:_,views:V,contentType:e}}function q(i,m){if(!i)return null;const v=i.slug||`news-${m+1}`,C=i.category||"News",O=I({...i,id:i.id||`news-${m+1}`,slug:v,category:C,contentFile:i.contentFile},m+1e3,"news"),D=T(O.date),e=[C,D].filter(Boolean);return O.metaLabel=e.join(" \u2022 ")||C,O.views=O.views||1200-m*15,O.region=C,O}function N(i){return fetch(i).then(m=>{if(!m.ok)throw new Error(`${i} responded with ${m.status}`);return m.json()})}function B(){return N(o).catch(i=>(console.warn("MIROZA: Falling back to legacy posts feed",i),N(s))).catch(i=>(console.error("MIROZA: Unable to load article feed",i),[]))}function P(){return N(a).catch(i=>(console.error("MIROZA: Unable to load news feed",i),[]))}function L(i){return Array.isArray(i)?i:[]}function U(){return Promise.all([B(),P()]).then(([i,m])=>{const v=L(i).map((O,D)=>I(O,D,"article")).filter(O=>!k(O.category)).sort((O,D)=>(D.dateValue||0)-(O.dateValue||0)),C=L(m).map((O,D)=>q(O,D)).filter(Boolean).sort((O,D)=>(D.dateValue||0)-(O.dateValue||0));return w(m),t=[...C,...v],E(),t}).catch(i=>(console.error("Posts load failed",i),t=[],E(),t))}function w(i){var m,v;if((v=(m=window.MIROZA)==null?void 0:m.indiaNews)!=null&&v.prime&&Array.isArray(i)&&i.length)try{window.MIROZA.indiaNews.prime(i)}catch(C){console.warn("MIROZA: Unable to seed India desk from posts module",C)}}function E(){f.clear(),t.forEach(v=>{var O,D,e;const C=((e=(D=(O=v.id)!=null?O:v.slug)!=null?D:v.link)!=null?e:Math.random()).toString();f.set(C,v)}),b=t.filter(v=>h(v,"article")).slice().sort((v,C)=>(C.dateValue||0)-(v.dateValue||0)),l=t.slice().sort((v,C)=>(C.views||0)-(v.views||0)).slice(0,8),c=new Set(l.map(v=>v.id))}function S(i){const m=r(i);return m==="news"?Q():m==="article"?J():t.filter(v=>r(v.category)===m).sort((v,C)=>(C.dateValue||0)-(v.dateValue||0))}function x(i){if(!Array.isArray(i)||!i.length)return t.slice();const m=i.map(O=>r(O)),v=m.includes("article"),C=m.includes("news");return t.filter(O=>{const D=r(O.category);return v&&h(O,"article")||C&&h(O,"news")?!0:m.includes(D)}).sort((O,D)=>(D.dateValue||0)-(O.dateValue||0))}function $(i){return i?i.split(",").map(m=>r(m)).filter(Boolean):[]}function F(i){var v,C;const m=((C=(v=window.MIROZA.utils)==null?void 0:v.qsa)==null?void 0:C.call(v,".chip"))||[];m.length&&m.forEach(O=>{let D="";try{const n=new URL(O.href,window.location.origin).searchParams.get("topic");D=r(n||O.textContent||""),n?O.setAttribute("aria-current",D&&D===i?"page":"false"):O.setAttribute("aria-current",i?"false":"page")}catch(e){O.setAttribute("aria-current",i?"false":"page")}})}function W(i){var v,C,O;const m=(C=(v=window.MIROZA.utils)==null?void 0:v.qs)==null?void 0:C.call(v,"[data-category-label]");m&&(m.dataset.defaultTitle||(m.dataset.defaultTitle=((O=m.textContent)==null?void 0:O.trim())||""),i?m.textContent=`${i} Briefings`:m.dataset.defaultTitle&&(m.textContent=m.dataset.defaultTitle))}function j(){return l.slice(0,5)}function Y(i){return c.has(i)}function K(){const i=window.MIROZA.utils.qs("#trending-list");i&&(i.innerHTML="",j().forEach(m=>{const v=document.createElement("li"),C=document.createElement("a");C.href=m.link||"/articles/"+m.slug+".html",C.textContent=m.title,C.setAttribute("data-prefetch",""),C.setAttribute("data-transition","");const O=document.createElement("span");O.className="card-meta",O.textContent=m.metaLabel||window.MIROZA.utils.formatNumber(m.views||0)+" views",v.appendChild(C),v.appendChild(O),i.appendChild(v)}))}function Q(){return t.filter(i=>h(i,"news")).sort((i,m)=>(m.dateValue||0)-(i.dateValue||0))}function J(){return t.filter(i=>h(i,"article")).sort((i,m)=>(m.dateValue||0)-(i.dateValue||0))}function ne(){var i,m,v,C,O;try{let g=function(z){Array.isArray(z)&&(e=z.map(V=>({...V}))),n=[...D,...e].sort((V,H)=>{const we=V.dateValue||Date.parse(V.date||0)||0;return(H.dateValue||Date.parse(H.date||0)||0)-we})};const D=[...t];let e=[],n=[];g();let A="all";const Z=window.MIROZA.pagination.mount({targetSelector:"#latest-cards",controlsSelector:"#latest-pagination",getData:()=>ae(n,A),pageSize:8,emptyMessage:"Fresh stories are on the way.",mode:"load-more",autoLoad:!0});(i=window.MIROZA.filters)==null||i.initLatest({onChange:z=>{A=z,Z==null||Z.render()}}),(m=window.MIROZA.blogs)!=null&&m.ready&&window.MIROZA.blogs.ready().then(()=>{const z=window.MIROZA.blogs.all?window.MIROZA.blogs.all():window.MIROZA.blogs.latest(20);g(z),Z==null||Z.render({reset:!0})}).catch(()=>{}),window.MIROZA.pagination.mount({targetSelector:"#news-cards",controlsSelector:"#news-pagination",getData:()=>Q(),pageSize:6,emptyMessage:"News stories publishing soon.",mode:"load-more"}),window.MIROZA.pagination.mount({targetSelector:"#articles-cards",controlsSelector:"#articles-pagination",getData:()=>J(),pageSize:6,emptyMessage:"Long-form stories publishing soon.",mode:"load-more"}),K();const _=b.slice(0,5);(v=window.MIROZA.hero)==null||v.mount(_),(O=(C=window.MIROZA.ui)==null?void 0:C.hydrateLazySections)==null||O.call(C),console.info("[MIROZA] Home sections rendered",{totalPosts:t.length,latestRendered:n.length,heroStories:_.length})}catch(D){console.error("MIROZA: Failed to render home layout",D);const e=document.getElementById("latest-cards");if(e){e.innerHTML="";const n=document.createElement("p");n.className="card-excerpt",n.textContent="We hit a snag while loading stories. Please refresh to try again.",e.appendChild(n)}}}function ae(i,m){if(m==="all")return i;const v=r(m);return v==="article"?i.filter(C=>h(C,"article")):v==="news"?i.filter(C=>h(C,"news")):v==="blog"?i.filter(C=>h(C,"blog")):i.filter(C=>r(C.category)===v)}function oe(){var A;const i=document.body.dataset.category;if(!i)return;if((i||"").toLowerCase()==="blog"){(A=window.MIROZA.blogs)==null||A.ready().then(()=>window.MIROZA.blogs.mountCategorySection()).catch(()=>{}),K();return}const v=$(document.body.dataset.categories||""),C=typeof URLSearchParams!="undefined"?new URLSearchParams(window.location.search||""):null,O=(C==null?void 0:C.get("topic"))||"",D=r(O),e=v.length?x(v):S(i),n=D?e.filter(Z=>r(Z.category)===D):e,g=D&&O?`${O} coverage is publishing soon.`:`${i} stories publishing soon.`;W(O),F(D),window.MIROZA.pagination.mount({targetSelector:"#category-list",controlsSelector:"#category-pagination",getData:()=>n,pageSize:10,emptyMessage:g,mode:"load-more",autoLoad:!0}),K()}function X(){const i=document.body.dataset.page;i==="home"&&ne(),i==="category"&&oe(),i||K()}function ee(){return u?u.then(()=>X()):u=U().then(()=>(X(),t)),u}function ie(){return u!=null?u:u=U()}function se(){return b.slice(0,5)}function ce(i){return i?f.get(i.toString())||t.find(m=>(m.slug||"")===i):null}return{init:ee,ready:ie,posts:()=>t,filterByCategory:S,trending:j,isTrending:Y,heroFeed:se,byId:ce}})(),window.MIROZA.blogs=(function(){const o="/data/blogs.json";let s=[],a=[],t=null;function u(){return fetch(o).then(y=>y.json()).then(y=>(s=Array.isArray(y)?y:[],a=s.map(b).sort((d,h)=>(h.dateValue||0)-(d.dateValue||0)),a)).catch(y=>(console.error("MIROZA: Failed to load blogs",y),s=[],a=[],[]))}function b(y){const d=y.url||y.canonical||`/blogs/${y.slug||"blog-"+y.id}.html`,h=Date.parse(y.date||y.displayDate||"")||0,M=[y.displayDate,y.readTimeMinutes?`${y.readTimeMinutes} min read`:null].filter(Boolean);return{id:y.slug||`blog-${y.id}`,slug:y.slug,title:y.title,excerpt:y.excerpt,category:"Blog",link:d,metaLabel:M.join(" \u2022 ")||"Blog insight",date:y.date,dateValue:h,tags:y.tags||[],views:y.readTimeMinutes?y.readTimeMinutes*100:void 0,contentType:"blog"}}function c(y=8){return a.slice(0,y)}function l(){return a.slice()}function f(){const y=window.MIROZA.utils.qs("#blog-cards"),d=window.MIROZA.utils.qs("#blog-pagination");if(!y)return;const h=c(8);if(y.innerHTML="",!h.length){const M=document.createElement("p");M.className="card-excerpt",M.textContent="Blogs are publishing soon.",y.appendChild(M),d&&(d.innerHTML="");return}if(h.forEach((M,T)=>{const I=window.MIROZA.buildCard(M,{order:T});I&&y.appendChild(I)}),d){d.innerHTML="";const M=document.createElement("p");M.className="card-meta",M.textContent=`Showing ${h.length} of ${a.length} blog posts`,d.appendChild(M)}}function r(){const y="#category-list",d="#category-pagination",h=window.MIROZA.utils.qs(y),M=window.MIROZA.utils.qs(d);if(!(!h||!M)){if(!a.length){h.innerHTML="";const T=document.createElement("p");T.className="card-excerpt",T.textContent="Blog posts are publishing soon.",h.appendChild(T),M.innerHTML="";return}window.MIROZA.pagination.mount({targetSelector:y,controlsSelector:d,getData:()=>a,pageSize:10,emptyMessage:"Blog posts are publishing soon.",mode:"load-more",autoLoad:!0})}}function p(){const y=document.body.dataset.page,d=(document.body.dataset.category||"").toLowerCase();y==="home"&&f(),y==="category"&&d==="blog"&&r()}function R(){return t||(t=u()),t.then(()=>p()),t}function k(){return t!=null?t:t=u()}return{init:R,ready:k,latest:c,all:l,renderHomeSection:f,mountCategorySection:r}})(),window.MIROZA.pagination=(function(){function o({targetSelector:s,controlsSelector:a,getData:t,pageSize:u=10,emptyMessage:b="More stories coming soon.",mode:c="paged",autoLoad:l=!1}){const f=window.MIROZA.utils.qs(s),r=window.MIROZA.utils.qs(a);if(!f||!r||typeof t!="function")return null;const p={page:0},R=c==="load-more";let k;function y(h){(typeof h=="boolean"?{reset:h}:h||{}).reset&&(p.page=0);const T=t()||[];if(!T.length){f.innerHTML="";const U=document.createElement("p");U.className="card-excerpt",U.textContent=b,f.appendChild(U),r.innerHTML="";return}const I=Math.max(1,Math.ceil(T.length/u));if(p.page=Math.min(p.page,I-1),R){d(T,I);return}const q=p.page*u,N=T.slice(q,q+u);f.innerHTML="",N.forEach((U,w)=>{const E=window.MIROZA.buildCard(U,{order:q+w});E&&f.appendChild(E)}),r.innerHTML="";const B=document.createElement("button");B.type="button",B.textContent="Previous",B.disabled=p.page===0,B.addEventListener("click",()=>{p.page>0&&(p.page--,y())});const P=document.createElement("span");P.className="page-indicator",P.textContent=`Page ${p.page+1} of ${I}`;const L=document.createElement("button");L.type="button",L.textContent="Next",L.disabled=p.page>=I-1,L.addEventListener("click",()=>{p.page<I-1&&(p.page++,y())}),r.appendChild(B),r.appendChild(P),r.appendChild(L)}y();function d(h,M){const T=Math.min((p.page+1)*u,h.length);f.innerHTML="",h.slice(0,T).forEach((N,B)=>{const P=window.MIROZA.buildCard(N,{order:B});P&&f.appendChild(P)}),r.innerHTML="";const I=document.createElement("button");I.type="button",I.className="load-more-btn";const q=p.page<M-1;I.textContent=q?"Load more stories":"All stories loaded",I.disabled=!q,I.addEventListener("click",()=>{p.page<M-1&&(p.page++,y())}),r.appendChild(I),l&&q&&"IntersectionObserver"in window&&(k==null||k.disconnect(),k=new IntersectionObserver(N=>{N.forEach(B=>{B.isIntersecting&&!I.disabled&&I.click()})},{rootMargin:"200px 0px"}),k.observe(I))}return{render:y}}return{mount:o}})(),window.MIROZA.indiaNews=(function(){const o="/data/news.json";let s=[],a=null,t=null;function u(d){const h=c(d);return h.length?(s=h,a=Promise.resolve(s),!0):!1}function b(){return fetch(o).then(d=>d.json()).then(d=>(u(d),s)).catch(d=>(console.error("MIROZA: Unable to load India news feed",d),s=[],s))}function c(d){return(Array.isArray(d)?d:[]).map((M,T)=>{const I=M.slug||`india-news-${T+1}`,q=M.date||"",N=l(q),B=M.category||"India",P=M.title||"India desk update";return{id:I,slug:I,title:P,excerpt:M.excerpt||"",category:B,date:q,metaLabel:N?`${B} \u2022 ${N}`:B,link:M.contentFile||`/news/${I}.html`,image:M.image?{src:M.image,alt:P,sizes:te}:G}}).sort((M,T)=>{const I=new Date(M.date||0).getTime();return new Date(T.date||0).getTime()-I})}function l(d){if(!d)return"";const h=new Date(d);if(isNaN(h))return d;try{return new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",year:"numeric"}).format(h)}catch(M){return h.toISOString().slice(0,10)}}function f(){var d,h;((h=(d=document.body)==null?void 0:d.dataset)==null?void 0:h.page)==="home"&&window.MIROZA.utils.qs("#india-news-cards")&&window.MIROZA.pagination.mount({targetSelector:"#india-news-cards",controlsSelector:"#india-news-controls",getData:()=>s,pageSize:4,emptyMessage:"India desk coverage publishes shortly.",mode:"load-more",autoLoad:!0})}function r(){var d,h;((h=(d=document.body)==null?void 0:d.dataset)==null?void 0:h.page)==="india-news"&&window.MIROZA.utils.qs("#india-news-list")&&window.MIROZA.pagination.mount({targetSelector:"#india-news-list",controlsSelector:"#india-news-pagination",getData:()=>s,pageSize:6,emptyMessage:"India desk stories are being prepared.",mode:"load-more",autoLoad:!0})}function p(){var h,M;const d=(M=(h=document.body)==null?void 0:h.dataset)==null?void 0:M.page;if(!(!d||t===d)){if(d==="home"){f(),t=d;return}d==="india-news"&&(r(),t=d)}}function R(){var h,M;const d=(M=(h=document.body)==null?void 0:h.dataset)==null?void 0:M.page;d!=="home"&&d!=="india-news"||k().then(()=>p())}function k(){return a||(a=b()),a}function y(d){var h,M;if(u(d)){const T=(M=(h=document.body)==null?void 0:h.dataset)==null?void 0:M.page;(T==="home"||T==="india-news")&&window.requestAnimationFrame(()=>p())}}return{init:R,ready:k,items:()=>s.slice(),prime:y}})(),window.MIROZA.prefetch=(function(){const o="relList"in document.createElement("link")&&document.createElement("link").relList.supports&&document.createElement("link").relList.supports("prefetch");function s(t){const u=t.target.closest("a[data-prefetch]");if(!u||!o||u.dataset.prefetched)return;const b=document.createElement("link");b.rel="prefetch",b.href=u.href,document.head.appendChild(b),u.dataset.prefetched="true"}function a(){document.addEventListener("mouseover",s),document.addEventListener("touchstart",s,{passive:!0})}return{init:a}})(),window.MIROZA.ui=(function(){let o,s,a,t=!1,u;const b=2500;function c(){const d=window.scrollY||document.documentElement.scrollTop||0;o&&o.classList.toggle("is-stuck",d>24),s&&s.classList.toggle("visible",d>480)}function l(){s&&s.addEventListener("click",()=>{const d=window.MIROZA.utils.prefersReducedMotion()?"auto":"smooth";window.scrollTo({top:0,behavior:d})})}function f(){const d=window.MIROZA.utils.qsa("[data-lazy]");if(d.length){if(!("IntersectionObserver"in window)){d.forEach(h=>h.classList.add("lazy-ready"));return}a==null||a.disconnect(),a=new IntersectionObserver(h=>{h.forEach(M=>{M.isIntersecting&&(M.target.classList.add("lazy-ready"),a.unobserve(M.target))})},{rootMargin:"0px 0px -10% 0px"}),d.forEach(h=>a.observe(h)),window.clearTimeout(u),u=window.setTimeout(r,b)}}function r(){window.MIROZA.utils.qsa("[data-lazy]:not(.lazy-ready)").forEach(d=>d.classList.add("lazy-ready"))}function p(){o=window.MIROZA.utils.qs(".site-header"),s=window.MIROZA.utils.qs(".back-to-top"),l(),window.addEventListener("scroll",()=>{t||(t=!0,window.requestAnimationFrame(()=>{c(),t=!1}))},{passive:!0}),c(),f(),R()}function R(){const d=window.MIROZA.utils.qsa(".single-article img, main img[data-enhance-responsive]");d.length&&d.forEach(h=>{if(h&&(h.getAttribute("loading")||(h.loading="lazy"),h.decoding="async",!h.hasAttribute("srcset"))){const M=k(h.getAttribute("src"));M&&(h.setAttribute("srcset",M),h.hasAttribute("sizes")||h.setAttribute("sizes","(max-width: 900px) 100vw, 800px"))}})}function k(d){return!d||!/images\.(unsplash|pexels)\.com/i.test(d)?null:[480,768,1200].map(T=>`${y(d,T)} ${T}w`).join(", ")}function y(d,h){const M=`w=${h}`;if(/w=\d+/i.test(d))return d.replace(/w=\d+/gi,M);const T=d.includes("?")?"&":"?";return`${d}${T}${M}`}return{init:p,hydrateLazySections:f}})(),window.MIROZA.forms=(function(){const o="miroza_newsletter_optin";function a(p){return typeof p!="string"?"":window.DOMPurify?DOMPurify.sanitize(p,{ALLOWED_TAGS:[],ALLOWED_ATTR:[]}):p.replace(/[<>]/g,"")}function t(p){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(p)}function u(p,R,k){try{if(p==="get")return localStorage.getItem(R);p==="set"&&localStorage.setItem(R,k),p==="remove"&&localStorage.removeItem(R)}catch(y){}return null}function b(p,R,k="info"){p&&(p.textContent=R,p.dataset.state=k)}function c(p){p.classList.add("is-success"),window.MIROZA.utils.qsa("input, button",p).forEach(R=>{R.disabled=!0})}function l(p){return new Promise(R=>{window.setTimeout(()=>R({ok:!0,...p}),900)})}function f(){const p=window.MIROZA.utils.qs("#newsletter-form");if(!p)return;const R=p.querySelector('input[type="email"]'),k=p.querySelector(".form-feedback"),y=p.querySelector('button[type="submit"]');!R||!k||!y||(u("get",o)==="subscribed"&&(b(k,"You are already subscribed.","success"),c(p)),p.addEventListener("submit",d=>{if(d.preventDefault(),p.classList.contains("is-loading"))return;const h=a(R.value.trim());if(!t(h)){b(k,"Enter a valid email address.","error"),R.focus();return}p.classList.add("is-loading"),y.disabled=!0,b(k,"Subscribing you now\u2026","pending");const M=T=>{p.classList.remove("is-loading"),T||(y.disabled=!1)};l({email:h}).then(()=>{b(k,"You are officially on the list. Welcome aboard!","success"),u("set",o,"subscribed"),c(p),M(!0)}).catch(()=>{b(k,"We could not reach the server. Please try again.","error"),M(!1)})}))}function r(){f()}return{init:r}})(),window.MIROZA.community=(function(){const o="miroza_comments_v1",s="miroza_likes_v1";let t={},u=null;function b(w){return typeof w!="string"?"":window.DOMPurify?DOMPurify.sanitize(w,{ALLOWED_TAGS:[],ALLOWED_ATTR:[]}):w.replace(/[<>]/g,"")}function c(){const w=document.body;return w.dataset.articleId?w.dataset.articleId:w.dataset.slug?w.dataset.slug:window.location.pathname.replace(/\/+/g,"/").replace(/\/$/,"")||"home"}function l(){try{const w=localStorage.getItem(o);return w&&(t=JSON.parse(w)||{}),t}catch(w){return t}}function f(w){t=w;try{localStorage.setItem(o,JSON.stringify(w))}catch(E){}}function r(){if(u)return u;try{const w=localStorage.getItem(s);u=w?JSON.parse(w):{}}catch(w){u={}}return u}function p(w){u=w;try{localStorage.setItem(s,JSON.stringify(w))}catch(E){}}function R(w,E,S="info"){w&&(w.textContent=E,w.dataset.state=S)}function k(w){try{return new Intl.DateTimeFormat("en",{month:"short",day:"numeric",year:"numeric"}).format(new Date(w))}catch(E){return new Date(w).toLocaleDateString()}}function y(w,E){if(w){if(w.innerHTML="",!E.length){const S=document.createElement("li");S.className="card-meta",S.textContent="No comments yet. Share your perspective below (stored locally only).",w.appendChild(S);return}E.forEach(S=>{const x=document.createElement("li");x.className="comment-card";const $=document.createElement("div");$.className="comment-meta",$.textContent=`${S.name} \u2022 ${k(S.ts)}`;const F=document.createElement("p");F.textContent=S.comment,x.appendChild($),x.appendChild(F),w.appendChild(x)})}}function d(w){const E=c(),S={...l()},x=S[E]?[...S[E]]:[];return x.push(w),S[E]=x.slice(-20),f(S),S[E]}function h(w,E){const S=c(),x={...r()},$=!x[S];$?x[S]=!0:delete x[S],p(x),w&&(w.dataset.liked=$?"true":"false",w.setAttribute("aria-pressed",$?"true":"false"),w.textContent=$?"\u2665 Liked":"\u2661 Appreciate"),R(E,$?"Thanks for the love!":"Like removed.","success")}function M(w,E,S){var j,Y;const x=window.location.href,$=document.title,F=((j=document.querySelector('meta[name="description"]'))==null?void 0:j.content)||"Discover more from MIROZA.",W=encodeURIComponent(x);if(w==="like"){h(S,E);return}if(w==="copy"){(Y=navigator.clipboard)!=null&&Y.writeText?navigator.clipboard.writeText(x).then(()=>R(E,"Link copied to clipboard.","success")).catch(()=>T(x,E)):T(x,E);return}if(w==="twitter"){window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent($)}&url=${W}`,"_blank","noopener"),R(E,"Opening X (Twitter)\u2026","pending");return}if(w==="linkedin"){window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${W}`,"_blank","noopener"),R(E,"Opening LinkedIn\u2026","pending");return}if(w==="native"&&navigator.share){navigator.share({title:$,text:F,url:x}).then(()=>R(E,"Thanks for sharing!","success")).catch(()=>R(E,"Share cancelled.","info"));return}M("copy",E)}function T(w,E){window.prompt("Copy this link and share it anywhere:",w)!==null&&R(E,"Copy the highlighted link to share.","info")}function I(w){let E=w.querySelector(".share-actions");if(!E){E=document.createElement("div"),E.className="share-actions",E.setAttribute("aria-label","Share actions");const x=[{type:"native",label:"Quick share"},{type:"twitter",label:"Post to X"},{type:"linkedin",label:"Share on LinkedIn"},{type:"copy",label:"Copy link"}],$=document.createDocumentFragment();x.forEach(Y=>{const K=document.createElement("button");K.type="button",K.dataset.share=Y.type,K.textContent=Y.label,$.appendChild(K)});const F=document.createElement("button");F.type="button",F.dataset.share="like",F.classList.add("like-btn");const W=!!r()[c()];F.dataset.liked=W?"true":"false",F.setAttribute("aria-pressed",W?"true":"false"),F.textContent=W?"\u2665 Liked":"\u2661 Appreciate",$.appendChild(F),E.appendChild($);const j=w.querySelector("header");j?j.insertAdjacentElement("afterend",E):w.prepend(E)}let S=w.querySelector(".share-feedback");return S||(S=document.createElement("p"),S.className="form-feedback share-feedback",S.setAttribute("aria-live","polite"),S.textContent="",E.insertAdjacentElement("afterend",S)),{block:E,feedback:S}}function q(w){let E=w.querySelector(".comments");if(!E){const x=`comments-${(c().split("/").pop()||"story").replace(/[^a-z0-9]+/gi,"-")}`;E=document.createElement("section"),E.className="comments",E.setAttribute("aria-labelledby",`${x}-heading`),E.innerHTML=`
          <h2 id="${x}-heading">Join the conversation</h2>
          <form class="comment-form" novalidate>
            <label for="${x}-name">Name</label>
            <input type="text" id="${x}-name" name="name" maxlength="60" placeholder="Your name" required />
            <label for="${x}-body">Comment</label>
            <textarea id="${x}-body" name="comment" maxlength="500" placeholder="Be constructive and kind." required></textarea>
            <input type="text" name="company" class="hidden" tabindex="-1" autocomplete="off" aria-hidden="true" />
            <p class="form-feedback" aria-live="polite"></p>
            <button type="submit">Post comment</button>
          </form>
          <ul class="comment-list" aria-live="polite"></ul>
        `,w.appendChild(E)}return E}function N(w,E){!w||w.dataset.shareBound||(w.dataset.shareBound="true",w.addEventListener("click",S=>{const x=S.target.closest("button[data-share]");if(!x)return;const $=x.dataset.share;M($,E,x)}))}function B(w){const E=w.querySelector("form"),S=w.querySelector(".comment-list"),x=E.querySelector(".form-feedback"),F=l()[c()]||[];y(S,F),R(x,"Comments stay on this device until realtime APIs are wired up.","info"),E.addEventListener("submit",W=>{W.preventDefault();const j=new FormData(E);if(j.get("company")){E.reset();return}const Y=b((j.get("name")||"Guest").trim()).slice(0,60)||"Guest",K=b((j.get("comment")||"").trim());if(K.length<5){R(x,"Please add a bit more detail (minimum 5 characters).","error");return}const Q={name:Y,comment:K,ts:Date.now()},J=d(Q);y(S,J),R(x,"Comment captured locally for preview. \u2705","success"),E.reset()})}function P(){if(document.body.dataset.page!=="article")return;const w=window.MIROZA.utils.qs(".single-article");if(!w)return;const{block:E,feedback:S}=I(w);N(E,S);const x=q(w);B(x)}function L(){P()}function U(){return{...r()}}return{init:L,getLikedMap:U}})(),window.MIROZA.breadcrumbs=(function(){const o={article:{label:"Articles",href:"/articles.html"},"blog-article":{label:"Blogs",href:"/blog.html"},"news-article":{label:"News",href:"/news.html"}};function s(){var p,R,k;const u=(R=(p=document.body)==null?void 0:p.dataset)==null?void 0:R.page;if(!u||!o[u])return;const b=window.MIROZA.utils.qs(".single-article")||window.MIROZA.utils.qs("main");if(!b||b.querySelector(".breadcrumbs"))return;const c=b.querySelector("h1")||window.MIROZA.utils.qs("h1"),l=(k=c==null?void 0:c.textContent)==null?void 0:k.trim();if(!l)return;const f=a(u,l),r=t(f);r&&b.insertAdjacentElement("afterbegin",r)}function a(u,b){const c=[{label:"Home",href:"/"}],l=o[u];return l&&c.push(l),c.push({label:b,current:!0}),c}function t(u){if(!Array.isArray(u)||u.length<2)return null;const b=document.createElement("nav");b.className="breadcrumbs",b.setAttribute("aria-label","Breadcrumb");const c=document.createElement("ol");return u.forEach(l=>{const f=document.createElement("li");if(l.current||!l.href)f.textContent=l.label,f.setAttribute("aria-current","page");else{const r=document.createElement("a");r.href=l.href,r.textContent=l.label,r.setAttribute("data-prefetch",""),f.appendChild(r)}c.appendChild(f)}),b.appendChild(c),b}return{init:s}})(),window.MIROZA.search=(function(){let a,t,u=[],b=[],c=[],l=-1,f;function r(){var I;a=window.MIROZA.utils.qs("#search"),t=window.MIROZA.utils.qs("#search-suggestions"),!(!a||!t)&&(p(),window.MIROZA.posts.ready().then(q=>{u=q||[]}).catch(()=>{}),(I=window.MIROZA.blogs)!=null&&I.ready&&window.MIROZA.blogs.ready().then(q=>{b=q?window.MIROZA.blogs.all?window.MIROZA.blogs.all():q:[]}).catch(()=>{}))}function p(){a.addEventListener("input",R,{passive:!0}),a.addEventListener("focus",()=>{a.value.trim().length>=2&&k(a.value.trim())}),a.addEventListener("keydown",d),document.addEventListener("click",I=>{I.target===a||t.contains(I.target)||T()}),t.addEventListener("mousedown",I=>I.preventDefault()),t.addEventListener("click",I=>{const q=I.target.closest(".search-suggestion");if(!q)return;const N=Number(q.dataset.index);M(N)})}function R(){const I=a.value.trim();if(window.clearTimeout(f),I.length<2){T();return}f=window.setTimeout(()=>k(I),120)}function k(I){const q=I.toLowerCase(),B=[...u,...b].filter(P=>[P.title,P.excerpt,P.category].filter(Boolean).join(" ").toLowerCase().includes(q)).slice(0,5).map(P=>({title:P.title,category:P.category||"Story",link:P.link||(P.slug?`/articles/${P.slug}.html`:"#")}));c=B,l=B.length?0:-1,y()}function y(){if(t){if(t.innerHTML="",!c.length){T();return}c.forEach((I,q)=>{const N=document.createElement("button");N.type="button",N.className="search-suggestion"+(q===l?" is-active":""),N.dataset.index=String(q),N.setAttribute("role","option");const B=document.createElement("strong");B.textContent=I.title;const P=document.createElement("span");P.textContent=I.category,N.appendChild(B),N.appendChild(P),t.appendChild(N)}),t.hidden=!1}}function d(I){t.hidden||(I.key==="ArrowDown"?(I.preventDefault(),h(1)):I.key==="ArrowUp"?(I.preventDefault(),h(-1)):I.key==="Enter"?l>-1&&(I.preventDefault(),M(l)):I.key==="Escape"&&T())}function h(I){c.length&&(l=(l+I+c.length)%c.length,y())}function M(I){const q=c[I];q&&(window.location.href=q.link,T())}function T(){t&&(t.hidden=!0,l=-1,t.innerHTML="")}return{init:r}})(),window.MIROZA.filters=(function(){let o=null;function s({onChange:t}={}){const u=window.MIROZA.utils.qs("#latest-filters");if(!u)return;const b=window.MIROZA.utils.qsa("button[data-filter]",u);if(!b.length)return;let c="all";function l(f){c=f,b.forEach(r=>r.setAttribute("aria-pressed",r.dataset.filter===c?"true":"false")),t==null||t(c)}o={setActive:l},u.addEventListener("click",f=>{const r=f.target.closest("button[data-filter]");!r||r.dataset.filter===c||l(r.dataset.filter)})}function a(t){t&&(o==null||o.setActive(t))}return{initLatest:s,setLatestFilter:a}})(),window.MIROZA.quickFind=(function(){const o={recent:"miroza_recent_reads_v1",saved:"miroza_saved_stories_v1"},s=8,a={recents:[],savedManual:[]},t={panel:null,toggle:null,recent:null,saved:null,categories:null,title:null},u=new Set;let b=[],c=[],l=null;function f(){r(),!(!t.panel||!t.toggle)&&(y(),p(),R(),k(),X(),ee(),ie())}function r(){t.panel=document.getElementById("quick-find"),t.toggle=window.MIROZA.utils.qs(".quick-find-toggle"),t.recent=document.getElementById("quick-find-recent"),t.saved=document.getElementById("quick-find-saved"),t.categories=document.getElementById("quick-find-categories"),t.title=document.getElementById("quick-find-title")}function p(){window.MIROZA.utils.qsa("#latest-filters button[data-filter]").forEach(e=>{e!=null&&e.dataset.filter&&u.add(e.dataset.filter)})}function R(){var e;t.toggle.addEventListener("click",U),window.MIROZA.utils.qsa('[data-close="quick-find"]',t.panel).forEach(n=>n.addEventListener("click",L)),document.addEventListener("keydown",M),document.addEventListener("click",T,!0),t.panel.addEventListener("click",I),(e=t.categories)==null||e.addEventListener("click",q)}function k(){var g,A,Z,_;const e=((A=(g=window.MIROZA.posts)==null?void 0:g.ready)==null?void 0:A.call(g))||Promise.resolve([]),n=((_=(Z=window.MIROZA.blogs)==null?void 0:Z.ready)==null?void 0:_.call(Z).then(()=>window.MIROZA.blogs.all?window.MIROZA.blogs.all():[]))||Promise.resolve([]);Promise.all([e,n]).then(([z,V])=>{b=[...z||[],...V||[]],ie(),ee()}).catch(()=>{})}function y(){a.recents=d(o.recent),a.savedManual=d(o.saved)}function d(e){var n;try{const g=(n=window.localStorage)==null?void 0:n.getItem(e);return g?JSON.parse(g):[]}catch(g){return[]}}function h(e,n){var g;try{(g=window.localStorage)==null||g.setItem(e,JSON.stringify(n))}catch(A){}}function M(e){if(e.key==="Escape"&&w()){e.preventDefault(),L();return}if((e.key==="k"||e.key==="K")&&(e.metaKey||e.ctrlKey)){const n=e.target;if(B(n))return;e.preventDefault(),P()}}function T(e){const n=e.target.closest("a[data-track-story]");if(!n)return;const g=E(n);g&&x(g)}function I(e){const n=e.target.closest("[data-quick-find-action]");if(n){const{quickFindAction:A,storyId:Z,storyHref:_}=n.dataset;A==="save"&&W(Z,_),A==="remove"&&j(Z,_);return}e.target.closest(".quick-find__details a")&&L()}function q(e){var A,Z;const n=e.target.closest("button[data-category]");if(!n)return;const g=n.dataset.action;if(g==="filter"){const _=n.dataset.filterKey||n.dataset.category;_&&((Z=(A=window.MIROZA.filters)==null?void 0:A.setLatestFilter)==null||Z.call(A,_)),L(),D(()=>N(_));return}g==="navigate"&&n.dataset.href&&(L(),window.location.href=n.dataset.href)}function N(e){e&&window.setTimeout(()=>{const n=window.MIROZA.utils.qs(`#latest-filters button[data-filter="${e}"]`);n==null||n.focus()},220)}function B(e){if(!e)return!1;const n=e.tagName;return e.isContentEditable||n==="INPUT"||n==="TEXTAREA"||n==="SELECT"}function P(){w()||(l=document.activeElement,t.panel.hidden=!1,document.body.classList.add("quick-find-open"),t.toggle.setAttribute("aria-expanded","true"),window.requestAnimationFrame(()=>{var e;return(e=t.title)==null?void 0:e.focus()}),X(),ee())}function L(){var e;w()&&(t.panel.hidden=!0,document.body.classList.remove("quick-find-open"),t.toggle.setAttribute("aria-expanded","false"),(e=l==null?void 0:l.focus)==null||e.call(l),l=null)}function U(){w()?L():P()}function w(){return!!t.panel&&!t.panel.hidden}function E(e){var _;const n=e.dataset||{},g=e.href;if(!g)return null;const A=S(n.trackStory||n.trackSlug),Z=n.trackTitle||(A==null?void 0:A.title)||((_=e.textContent)==null?void 0:_.trim());return Z?{id:n.trackStory||(A==null?void 0:A.id)||n.trackSlug||g,slug:n.trackSlug||(A==null?void 0:A.slug)||"",title:Z,category:n.trackCategory||(A==null?void 0:A.category)||"Story",href:g,ts:Date.now()}:null}function S(e){var n,g;return e&&((g=(n=window.MIROZA.posts)==null?void 0:n.byId)==null?void 0:g.call(n,e))||null}function x(e){if(!e)return;const n=a.recents.filter(g=>!J(g,e.id,e.href));a.recents=[e,...n].slice(0,s),$(),w()&&X()}function $(){h(o.recent,a.recents)}function F(){h(o.saved,a.savedManual.slice(0,s))}function W(e,n){const g=a.savedManual.findIndex(A=>J(A,e,n));if(g>-1)a.savedManual.splice(g,1);else{const A=Y(e,n);A&&a.savedManual.unshift({...A,ts:Date.now()})}a.savedManual=a.savedManual.slice(0,s),F(),ee(),X()}function j(e,n){const g=a.savedManual.filter(A=>!J(A,e,n));g.length!==a.savedManual.length&&(a.savedManual=g,F(),ee(),X())}function Y(e,n){return a.recents.find(g=>J(g,e,n))||a.savedManual.find(g=>J(g,e,n))||Q(S(e)||K(n))}function K(e){var n,g,A;if(!e||!b.length)return null;try{const _=(n=new URL(e,window.location.origin).pathname.split("/").pop())==null?void 0:n.replace(".html","");return _&&((A=(g=window.MIROZA.posts)==null?void 0:g.byId)==null?void 0:A.call(g,_))||null}catch(Z){return null}}function Q(e){if(!e)return null;const n=Date.parse(e.date||"")||Date.now();return{id:e.id||e.slug||e.link,slug:e.slug||"",title:e.title,category:e.category||"Story",href:e.link||(e.slug?`/articles/${e.slug}.html`:"#"),ts:n}}function J(e,n,g){return e?!!(n&&(e.id===n||e.slug===n)||g&&e.href===g):!1}function ne(){return c=ae(),c}function ae(){const e=new Set,n=a.savedManual.map(A=>({...A,origin:"manual"})),g=oe();return[...n,...g].filter(A=>{const Z=A.id||A.href;return!Z||e.has(Z)?!1:(e.add(Z),!0)})}function oe(){var n,g;const e=((g=(n=window.MIROZA.community)==null?void 0:n.getLikedMap)==null?void 0:g.call(n))||{};return Object.keys(e).map(A=>{var z,V;const Z=A.split("/").filter(Boolean).pop(),_=Z?((V=(z=window.MIROZA.posts)==null?void 0:z.byId)==null?void 0:V.call(z,Z))||b.find(H=>H.slug===Z):null;return _?{...Q(_),origin:"liked"}:null}).filter(Boolean)}function X(){if(!t.recent)return;const e=document.createDocumentFragment(),n=a.recents,g=new Set(ne().map(A=>A.id||A.href));n.length?n.forEach(A=>e.appendChild(C(A,{allowToggle:!0,isPinned:g.has(A.id||A.href)}))):e.appendChild(v("Explore a story to see it here.")),t.recent.innerHTML="",t.recent.appendChild(e)}function ee(){if(!t.saved)return;const e=document.createDocumentFragment(),n=ne();n.length?n.forEach(g=>e.appendChild(C(g,{allowRemoval:g.origin==="manual"}))):e.appendChild(v("Tap the heart inside an article or pin a recent story.")),t.saved.innerHTML="",t.saved.appendChild(e)}function ie(){if(!t.categories)return;t.categories.innerHTML="";const e=se();if(!e.length){const n=document.createElement("p");n.className="quick-find__meta",n.textContent="Stories are loading\u2026",t.categories.appendChild(n);return}e.forEach(n=>{const g=document.createElement("button");g.type="button",g.dataset.category=n.slug,g.dataset.action=n.action,n.filterKey&&(g.dataset.filterKey=n.filterKey),n.href&&(g.dataset.href=n.href),g.textContent=`${n.label} (${n.count})`,t.categories.appendChild(g)})}function se(){if(!b.length)return[];const e={};return b.forEach(n=>{const g=(n.category||"").trim();if(!g)return;const A=m(g);A&&(e[A]||(e[A]={label:g,slug:A,count:0}),e[A].count+=1,e[A].label=g)}),Object.values(e).sort((n,g)=>g.count-n.count).slice(0,8).map(n=>{const g=i(n.slug);if(g)return{...n,action:"filter",filterKey:g};const A=ce(n.slug);return A?{...n,action:"navigate",href:A}:null}).filter(Boolean)}function ce(e){return e?fe(e):null}function i(e){if(!e)return null;if(u.has(e))return e;if(e.endsWith("s")){const n=e.slice(0,-1);if(u.has(n))return n}return null}function m(e){return(e||"").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function v(e){const n=document.createElement("li");return n.className="empty",n.textContent=e,n}function C(e,{allowToggle:n=!1,isPinned:g=!1,allowRemoval:A=!1}={}){const Z=document.createElement("li"),_=document.createElement("div");_.className="quick-find__details";const z=document.createElement("a");z.href=e.href||"#",z.textContent=e.title,z.setAttribute("data-prefetch",""),z.setAttribute("data-track-story",e.id||e.slug||""),z.dataset.trackSlug=e.slug||"",z.dataset.trackTitle=e.title,z.dataset.trackCategory=e.category||"Story";const V=document.createElement("p");if(V.className="quick-find__meta",V.textContent=[e.category,O(e.ts)].filter(Boolean).join(" \u2022 "),_.appendChild(z),_.appendChild(V),Z.appendChild(_),n){const H=document.createElement("button");H.type="button",H.className="quick-find__action",H.dataset.quickFindAction="save",H.dataset.storyId=e.id||"",H.dataset.storyHref=e.href||"",H.textContent=g?"Saved":"Save",H.setAttribute("aria-pressed",g?"true":"false"),Z.appendChild(H)}else if(A){const H=document.createElement("button");H.type="button",H.className="quick-find__action",H.dataset.quickFindAction="remove",H.dataset.storyId=e.id||"",H.dataset.storyHref=e.href||"",H.textContent="Remove",Z.appendChild(H)}return Z}function O(e){if(!e)return"";const n=Date.now()-e,g=60*1e3,A=60*g,Z=24*A;try{const _=new Intl.RelativeTimeFormat("en",{numeric:"auto"});return n<g?"Just now":n<A?_.format(-Math.round(n/g),"minute"):n<Z?_.format(-Math.round(n/A),"hour"):_.format(-Math.round(n/Z),"day")}catch(_){return new Date(e).toLocaleString()}}function D(e){const n=document.getElementById("latest-heading");n&&n.scrollIntoView({behavior:window.MIROZA.utils.prefersReducedMotion()?"auto":"smooth",block:"start"}),typeof e=="function"&&window.setTimeout(e,300)}return{init:f,open:P,close:L}})(),window.MIROZA.analytics=(function(){const o={enabled:!1,plausibleDomain:"",debug:!1};let s={...o},a=!1;function t(){const f=window.MIROZA.analyticsConfig||{};s={...o,...f}}function u(){if(a||!s.plausibleDomain)return;if(document.querySelector('script[data-analytics="plausible"]')){a=!0;return}const r=document.createElement("script");r.src="https://plausible.io/js/plausible.js",r.defer=!0,r.dataset.domain=s.plausibleDomain,r.dataset.analytics="plausible",r.addEventListener("load",()=>{a=!0,s.debug&&console.info("[MIROZA]","Plausible analytics loaded")}),document.head.appendChild(r)}function b(...f){s.debug&&console.info("[MIROZA]",...f)}function c(){var f;if(s.debug){if(b("Debug diagnostics enabled"),window.addEventListener("load",()=>{var p,R,k;const r=(k=(R=(p=window.performance)==null?void 0:p.getEntriesByType)==null?void 0:R.call(p,"navigation"))==null?void 0:k[0];r&&b("Navigation timing (ms)",{domContentLoaded:Math.round(r.domContentLoadedEventEnd),total:Math.round(r.duration)})},{once:!0}),"PerformanceObserver"in window)try{new PerformanceObserver(p=>{p.getEntries().forEach(R=>b("Paint metric",R.name,Math.round(R.startTime)+"ms"))}).observe({type:"paint",buffered:!0})}catch(r){b("Paint observer unavailable",r.message)}(f=window.MIROZA.posts)!=null&&f.ready&&window.MIROZA.posts.ready().then(r=>{b("Posts available",r.length)}).catch(r=>console.warn("MIROZA diagnostics unable to read posts",r))}}function l(){t(),s.enabled&&u(),c()}return{init:l,config:()=>({...s})}})(),window.MIROZA.vitals=(function(){const o={},s="miroza_vitals_snapshot";function a(){"PerformanceObserver"in window&&(t("largest-contentful-paint",c=>u("lcp",c.renderTime||c.loadTime||c.startTime)),t("first-input",c=>u("fid",c.processingStart-c.startTime)),t("layout-shift",c=>{c.hadRecentInput||u("cls",(o.cls||0)+c.value)}))}function t(c,l){try{const f=new PerformanceObserver(p=>{p.getEntries().forEach(R=>l(R))}),r=c==="layout-shift"?{type:c,buffered:!0}:{type:c,buffered:!0};f.observe(r)}catch(f){}}function u(c,l){var f,r;typeof l!="number"||!isFinite(l)||(o[c]=l,b(),(r=(f=window.MIROZA.analytics)==null?void 0:f.config)!=null&&r.call(f).debug&&console.info("[MIROZA][Vitals]",c,l))}function b(){try{localStorage.setItem(s,JSON.stringify(o))}catch(c){}}return{init:a,get:()=>({...o})}})(),window.MIROZA.a11y=(function(){function o(){const t=window.MIROZA.utils.qs(".skip-link");t&&t.addEventListener("click",()=>{var u;(u=window.MIROZA.utils.qs("#main"))==null||u.focus()})}function s(){document.addEventListener("keydown",t=>{if(t.key==="Escape"){const u=window.MIROZA.utils.qs(".main-nav");u&&u.classList.contains("open")&&window.MIROZA.nav.toggle()}})}function a(){o(),s()}return{init:a}})(),window.MIROZA.pwa=(function(){function o(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").catch(s=>console.warn("SW registration failed",s))}return{register:o}})(),document.addEventListener("DOMContentLoaded",function(){window.MIROZA.shell.init(),window.MIROZA.analytics.init(),window.MIROZA.theme.init(),window.MIROZA.nav.init(),window.MIROZA.posts.init(),window.MIROZA.blogs.init(),window.MIROZA.indiaNews.init(),window.MIROZA.prefetch.init(),window.MIROZA.forms.init(),window.MIROZA.community.init(),window.MIROZA.search.init(),window.MIROZA.quickFind.init(),window.MIROZA.ui.init(),window.MIROZA.a11y.init(),window.MIROZA.vitals.init(),window.MIROZA.pwa.register(),window.MIROZA.breadcrumbs.init(),ge();const o=window.MIROZA.utils.qs(".theme-toggle");o&&o.addEventListener("click",window.MIROZA.theme.toggle);const s=window.MIROZA.utils.qs("#year");s&&(s.textContent=new Date().getFullYear())})})();

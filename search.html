<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Search Results - MIROZA</title>
  <link rel="stylesheet" href="styles/main.css" />
  <link rel="icon" type="image/svg+xml" href="assets/icons/logo.svg" />
</head>
<body>

  <!-- 1. Top Strip -->
  <div class="top-strip">
    <div class="container">
      <div class="ts-left">
        <span>Tuesday, Nov 25, 2025</span>
        <span class="separator">|</span>
        <span>Updated 09:45 AM IST</span>
      </div>
      <div class="ts-right">
        <span>EPAPER</span>
        <span class="separator">|</span>
        <span>SIGN IN</span>
      </div>
    </div>
  </div>

  <!-- 2. Header -->
  <header class="site-header">
    <div class="container header-grid">
      <button class="menu-toggle" aria-label="Toggle Menu"></button>
      
      <a href="index.html" class="logo">
        <img src="assets/icons/logo.svg" alt="Miroza Logo" />
        MIROZA
      </a>

      <div class="header-search">
        <form action="search.html" method="GET">
          <input type="text" name="q" placeholder="Search News, Articles..." required />
          <button type="submit" class="search-btn">
            <img src="assets/icons/search.svg" alt="Search" width="16" height="16" />
          </button>
        </form>
      </div>

      <button class="mobile-search-toggle" aria-label="Search">
        <img src="assets/icons/search.svg" alt="Search" width="24" height="24" />
      </button>
    </div>
  </header>

  <!-- 3. Nav Bar -->
  <nav class="main-nav-bar">
    <div class="container">
      <ul class="nav-list">
        <li><a href="index.html">Home</a></li>
        <li><a href="news.html">News</a></li>
        <li><a href="articles/articles.html">Articles</a></li>
        <li><a href="blog.html">Blogs</a></li>
        <li><a href="about.html">About Us</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="container main-layout">
    
    <!-- Left Column: Search Results -->
    <div class="col-center" style="grid-column: 1 / span 2;">
      <div class="section-heading-sm">
        <h3>Search Results for: <span id="query-display" style="color: var(--toi-red);">...</span></h3>
      </div>
      
      <p id="result-count" style="margin-bottom: 20px; color: var(--text-muted); font-size: 13px;">Searching...</p>

      <div id="loading" class="skeleton-block" style="height: 100px; margin-bottom: 20px;"></div>

      <div id="results-container" class="compact-list">
        <!-- Results injected here -->
      </div>

      <div id="no-results" style="display: none; padding: 40px 0; text-align: center;">
        <h3 style="margin-bottom: 10px;">No matches found</h3>
        <p style="color: var(--text-muted);">Try adjusting your search terms or browse our <a href="index.html" style="color: var(--toi-red); text-decoration: underline;">latest posts</a>.</p>
      </div>

      <div id="pagination" style="margin-top: 30px; text-align: center; display: none;">
        <button id="load-more-btn" style="background: var(--bg-secondary); border: 1px solid var(--border-color); padding: 10px 20px; cursor: pointer; font-weight: bold; color: var(--text-main);">LOAD MORE RESULTS</button>
      </div>
    </div>

    <!-- Right Column: Sidebar -->
    <aside class="col-right">
      <div class="ad-box-sm">ADVERTISEMENT</div>

      <div class="section-heading-sm">
        <h3>Trending Topics</h3>
      </div>
      <div class="tags-cloud">
        <a href="search.html?q=AI">Artificial Intelligence</a>
        <a href="search.html?q=Climate">Climate Change</a>
        <a href="search.html?q=Tech">Technology</a>
        <a href="search.html?q=Health">Health</a>
        <a href="search.html?q=Space">Space</a>
      </div>

      <div class="ad-box-lg">ADVERTISEMENT</div>
    </aside>

  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="container">
      <div class="footer-links">
        <div class="fl-col">
          <h4>Miroza</h4>
          <a href="about.html">About Us</a>
          <a href="contact.html">Contact Us</a>
          <a href="privacy.html">Privacy Policy</a>
          <a href="terms.html">Terms of Use</a>
        </div>
        <div class="fl-col">
          <h4>Sections</h4>
          <a href="news.html">News</a>
          <a href="articles/articles.html">Articles</a>
          <a href="blog.html">Blogs</a>
          <a href="videos.html">Videos</a>
        </div>
        <div class="fl-col">
          <h4>Connect</h4>
          <a href="#">Facebook</a>
          <a href="#">Twitter</a>
          <a href="#">Instagram</a>
          <a href="#">LinkedIn</a>
        </div>
      </div>
      <div class="copyright">
        Copyright  2025 Miroza Media. All rights reserved.
      </div>
    </div>
  </footer>

  <script src="scripts/app.js"></script>
  <script>
    // Search Logic
    document.addEventListener('DOMContentLoaded', async () => {
        const params = new URLSearchParams(window.location.search);
        const query = (params.get('q') || '').trim().toLowerCase();
        
        const displayEl = document.getElementById('query-display');
        const countEl = document.getElementById('result-count');
        const container = document.getElementById('results-container');
        const loading = document.getElementById('loading');
        const noResults = document.getElementById('no-results');
        const pagination = document.getElementById('pagination');
        const loadMoreBtn = document.getElementById('load-more-btn');

        if(displayEl) displayEl.textContent = query || 'All';

        // Update search input value
        const searchInput = document.querySelector('input[name="q"]');
        if(searchInput) searchInput.value = query;

        if (!query) {
            loading.style.display = 'none';
            countEl.textContent = 'Please enter a search term.';
            return;
        }

        // Load index
        try {
            // Note: Ensure /data/search.json exists. If not, this will fail gracefully.
            const res = await fetch('data/search.json');
            if(!res.ok) throw new Error('Failed to load index');
            const index = await res.json();
            
            // Filter
            const matches = index.filter(item => 
                (item.t || '').toLowerCase().includes(query) || 
                (item.c || '').toLowerCase().includes(query)
            );

            loading.style.display = 'none';
            countEl.textContent = ${matches.length} results found;

            if (matches.length === 0) {
                noResults.style.display = 'block';
                return;
            }

            // Render with pagination
            let page = 1;
            const pageSize = 10; // Show 10 per page
            
            function renderPage() {
                const start = (page - 1) * pageSize;
                const end = start + pageSize;
                const slice = matches.slice(start, end);
                
                slice.forEach(item => {
                    const li = document.createElement('li');
                    // Using the compact-list style from main.css
                    li.innerHTML = 
                        <a href="" style="display:flex; justify-content:space-between; align-items:center;">
                            <div>
                                <span style="font-size:11px; color:var(--toi-red); font-weight:bold; text-transform:uppercase;"></span>
                                <h4 style="margin-top:4px; font-size:16px; font-weight:bold; color:var(--text-main);"></h4>
                                <p style="font-size:13px; color:var(--text-muted); margin-top:4px;"></p>
                            </div>
                            <span style="font-size:20px; color:var(--border-color);"></span>
                        </a>
                    ;
                    container.appendChild(li);
                });

                if (end >= matches.length) {
                    pagination.style.display = 'none';
                } else {
                    pagination.style.display = 'block';
                }
            }

            renderPage();

            loadMoreBtn.addEventListener('click', () => {
                page++;
                renderPage();
            });

        } catch (err) {
            console.error(err);
            loading.style.display = 'none';
            countEl.textContent = 'Unable to load search results. Please try again later.';
        }
    });
  </script>
</body>
</html>

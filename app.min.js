!function(n){var e={postsUrl:"/data/posts.json",latestPerCategory:4,skeletonDelay:300,swPath:"/sw.js"},t={};t.initTheme=function(){try{var n=localStorage.getItem("miroza_theme");return n?void t.applyTheme(n):void t.applyTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}catch(e){t.applyTheme("light")}},t.applyTheme=function(n){"dark"===n?document.documentElement.classList.add("theme-dark"):document.documentElement.classList.remove("theme-dark"),localStorage.setItem("miroza_theme",n);var e=document.getElementById("themeToggle");e&&(e.textContent="dark"===n?"â˜€ï¸":"ðŸŒ™")},t.toggleTheme=function(){t.applyTheme(document.documentElement.classList.contains("theme-dark")?"light":"dark")},t.shuffle=function(n){for(var e=n.slice(),t=e.length-1;t>0;t--){var o=Math.floor(Math.random()*(t+1));o!==t&&(e[t]=e[t]^e[o],e[o]=e[t]^e[o],e[t]=e[t]^e[o])}return e},t.loadPosts=async function(){try{var e=await fetch(n.postsUrl,{cache:"no-cache"});if(!e.ok)throw new Error("Failed");var t=await e.json();return t.posts||[]}catch(o){return console.warn("MIROZA: could not load posts",o),[]}},t.renderCard=function(n){var e=document.createElement("article");e.className="card fade-in";var t=document.createElement("img");t.setAttribute("data-src",n.image),t.alt=n.title,t.loading="lazy",t.className="lazy",e.appendChild(t);var o=document.createElement("div");o.className="card-body";var c=document.createElement("h3"),a=document.createElement("a");a.href="/articles/"+n.slug+".html",a.textContent=n.title,a.rel="noopener noreferrer",c.appendChild(a);var r=document.createElement("p");r.className="muted",r.textContent=n.author+" â€¢ "+new Date(n.date).toLocaleDateString();var i=document.createElement("p");i.className="excerpt",i.textContent=n.excerpt,o.appendChild(c),o.appendChild(r),o.appendChild(i),e.appendChild(o);return e},t.renderCards=function(n,e){n.innerHTML="",e.forEach(function(e){n.appendChild(t.renderCard(e))}),t.lazyLoadImages()},t.lazyLoadImages=function(){var n=document.querySelectorAll("img.lazy");if("IntersectionObserver"in window){var e=new IntersectionObserver(function(n,o){n.forEach(function(n){if(n.isIntersecting){var o=n.target;o.src=o.getAttribute("data-src")||o.src,o.classList.remove("lazy"),oObserver&&oObserver.unobserve(o)}})});var o; n.forEach(function(n){e.observe(n)});var oObserver=e}else n.forEach(function(n){n.src=n.getAttribute("data-src")||n.src,n.classList.remove("lazy")});document.querySelectorAll("img").forEach(function(n){n.addEventListener("error",function(){n.src="/assets/hero-1.svg",n.alt="placeholder image"})})},t.initTicker=function(){var n=document.getElementById("tickerTrack");if(!n)return;n.innerHTML=n.innerHTML+n.innerHTML;var e=0,o=.4;!function n(){e-=o,Math.abs(e)>=n.scrollWidth/2&&(e=0),t.style&&(t.style.transform="translateX("+e+"px)"),requestAnimationFrame(n)}()},t.initNav=function(){var n=document.getElementById("hamburger"),e=document.getElementById("mainNav");n&&e&&n.addEventListener("click",function(){var t=e.classList.toggle("open");n.setAttribute("aria-expanded",t)}),document.querySelectorAll(".has-dropdown > a").forEach(function(n){n.addEventListener("click",function(e){window.innerWidth<700&&(e.preventDefault(),n.parentElement.classList.toggle("open"))})}),document.addEventListener("keydown",function(n){"Escape"===n.key&&(document.querySelectorAll(".has-dropdown.open").forEach(function(n){n.classList.remove("open")}),document.getElementById("mainNav")?.classList.remove("open"))})},t.initBackToTop=function(){var n=document.getElementById("backToTop");n&&(window.addEventListener("scroll",function(){window.scrollY>400?n.classList.add("show"):n.classList.remove("show")}),n.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})}))},t.initTransitions=function(){document.querySelectorAll("a").forEach(function(n){if(n.target&&"_blank"===n.target)return;n.addEventListener("click",function(e){var o=n.getAttribute("href");if(!o||o.startsWith("#")||o.startsWith("mailto:")||o.startsWith("tel:"))return; e.preventDefault(),document.documentElement.classList.add("is-transitioning"),setTimeout(function(){window.location.href=o},220)})}),window.addEventListener("pageshow",function(){document.documentElement.classList.remove("is-transitioning")})},t.renderHomepage=async function(){var n=await t.loadPosts(),e=n.slice().sort(function(n,e){return new Date(e.date)-new Date(n.date)});var o=n.slice().sort(function(n,e){return e.views-n.views}).slice(0,6),c=o.slice(0,5),a=e.slice(0,5);var r=document.getElementById("trendingList");r&&a.forEach(function(n){var e=document.createElement("li"),o=document.createElement("a");o.href="/articles/"+n.slug+".html",o.textContent=n.title,o.setAttribute("rel","noopener noreferrer"),e.appendChild(o),r.appendChild(e)});var i=document.getElementById("mostReadList");i&&c.forEach(function(n){var e=document.createElement("li"),o=document.createElement("a");o.href="/articles/"+n.slug+".html",o.textContent=n.title,e.appendChild(o),i.appendChild(e)});var u=document.getElementById("heroContent"),s=document.getElementById("heroSkeleton");setTimeout(function(){s&&s.remove()},e.config?.skeletonDelay||300);var l=e[0];l&&u&&(document.getElementById("heroTitle").textContent=l.title,document.getElementById("heroSummary").textContent=l.excerpt,document.getElementById("heroLink").href="/articles/"+l.slug+".html",document.querySelector(".hero-feature img").setAttribute("data-src",l.image),u.hidden=!1,t.lazyLoadImages());var d=document.getElementById("latestGrid");d&&(t.renderCards(d,e.slice(0,8)));var f=document.getElementById("topStories");if(f){var p=n.slice().sort(function(n,e){return new Date(e.date)-new Date(n.date)}).slice(0,5);p.forEach(function(n){var e=document.createElement("div");e.className="list-item";var o=document.createElement("a");o.href="/articles/"+n.slug+".html",o.textContent=n.title,e.appendChild(o),f.appendChild(e)})}var m=document.getElementById("categoriesGrid");if(m){var h=Array.from(new Set(n.map(function(n){return n.category})));h.forEach(function(e){var o=document.createElement("div");o.className="category-card";var c=document.createElement("h3");c.textContent=e,o.appendChild(c);var a=n.filter(function(n){return n.category===e}).sort(function(n,e){return new Date(e.date)-new Date(n.date)}),r=a.slice(0,this.config.latestPerCategory);r=(r||[]).slice();var g=t.shuffle(r);var v=document.createElement("div");v.className="mini-list",g.forEach(function(n){var e=document.createElement("article");e.className="mini";var o=document.createElement("img");o.src=n.image,o.alt=n.title,o.loading="lazy";var c=document.createElement("div"),a=document.createElement("h4"),r=document.createElement("a");r.href="/articles/"+n.slug+".html",r.textContent=n.title,a.appendChild(r);var i=document.createElement("p");i.className="muted",i.textContent=new Date(n.date).toLocaleDateString(),c.appendChild(a),c.appendChild(i),e.appendChild(o),e.appendChild(c),v.appendChild(e)}),o.appendChild(v);var y=document.createElement("a");y.className="viewmore small",y.href="category.html?cat="+encodeURIComponent(e),y.textContent="View all",o.appendChild(y),m.appendChild(o)})}},t.renderCategory=async function(){var n=new URLSearchParams(window.location.search).get("cat")||"All",e=await t.loadPosts(),o="All"===n?e:e.filter(function(e){return e.category.toLowerCase()===n.toLowerCase()});o.sort(function(n,e){return new Date(e.date)-new Date(n.date)});var c=document.getElementById("categoryList")||document.getElementById("latestGrid");c&&t.renderCards(c,o);var a=document.querySelector("h1");a&&(a.textContent="Category: "+n)},t.registerSW=function(){"serviceWorker"in navigator&&navigator.serviceWorker.register(n.swPath).catch(function(n){console.warn("SW registration failed",n)})},t.init=function(){t.initTheme(),document.getElementById("themeToggle")?.addEventListener("click",t.toggleTheme),t.initNav(),t.initTicker(),t.initBackToTop(),t.initTransitions();var n=window.location.pathname;n.endsWith("/index.html")||"/"===n||n.endsWith("/")?t.renderHomepage():n.endsWith("category.html")&&t.renderCategory(),document.getElementById("commentForm")&&(function(){var n=document.getElementById("commentForm"),e="miroza-comments",o=document.getElementById("commentsList");function c(){var n=localStorage.getItem(e)||"[]",t=JSON.parse(n);o.innerHTML="",t.forEach(function(n){var t=document.createElement("div");t.className="comment";var e=document.createElement("strong");e.textContent=n.name;var c=document.createElement("span");c.className="muted",c.textContent=" â€¢ "+n.date;var a=document.createElement("p");a.textContent=n.text,t.appendChild(e),t.appendChild(c),t.appendChild(a),o.appendChild(t)})}c(),n.addEventListener("submit",function(n){n.preventDefault();var t=n.target.querySelector('[name=name]').value.trim()||"Reader",o=n.target.querySelector('[name=text]').value.trim();if(!o)return;var r=localStorage.getItem(e)||"[]",i=JSON.parse(r);i.unshift({name:t,text:o,date:new Date().toLocaleString()}),localStorage.setItem(e,JSON.stringify(i)),n.target.reset(),c()})}()),t.registerSW()},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t.init):t.init(),window.MIROZA=t}( {postsUrl:"/data/posts.json",latestPerCategory:4,skeletonDelay:300,swPath:"/sw.js"} );